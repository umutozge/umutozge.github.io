<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://umutozge.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://umutozge.github.io/" rel="alternate" type="text/html" /><updated>2026-03-01T10:20:13+03:00</updated><id>https://umutozge.github.io/feed.xml</id><title type="html">Umut Özge</title><subtitle>Website for the courses offered by Dr. Umut Özge at the Graduate School of Informatics, Middle East Technical University.
</subtitle><entry><title type="html">Language primer</title><link href="https://umutozge.github.io/posts/course/language-primer/" rel="alternate" type="text/html" title="Language primer" /><published>2026-02-14T00:00:00+03:00</published><updated>2026-02-14T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/language-primer</id><content type="html" xml:base="https://umutozge.github.io/posts/course/language-primer/"><![CDATA[<div class="numbered">

  <p>This is a quick start on langugage for cognitive science students.</p>

  <h2 id="a-simple-formal-system">A simple formal system</h2>

  <p>Douglas Hofstadter<sup id="fnref:1"><a href="#fn:1" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> has this tiny formal system called <code class="language-plaintext highlighter-rouge">pq-System</code>. In
defining formal systems, we start with a set of symbols, called <strong>the
alphabet</strong>. This dictates that any expression of the system must be made by
bringing together, in some order, one or more of these symbols. Next, and the
last, step is to define which expressions formed out of these symbols are
<strong>well-formed</strong> in the system.</p>

  <p>This well-formedness step comes in two sub-steps.</p>

  <ol>
    <li>First we define the <strong>axioms</strong>, those expressions that we take to be
well-formed without any further justification.</li>
    <li>Second is <strong>the rules of production</strong> that allow us to generate new
well-formed expressions from already existing well-formed expressions.</li>
  </ol>

  <p>In <code class="language-plaintext highlighter-rouge">pq-System</code>, the alphabet consists of the following three symbols: <code class="language-plaintext highlighter-rouge">p</code>, <code class="language-plaintext highlighter-rouge">q</code>, and <code class="language-plaintext highlighter-rouge">-</code>.</p>

  <p>We have infinitely many axioms in <code class="language-plaintext highlighter-rouge">pq-System</code>, therefore we cannot list them
all. Instead, we provide a rule that generates all of the axioms, usually called
an <strong>axiom schema</strong>.</p>

  <div class="item" id="def:pq-axioms" data-kind="definition" data-label="Definition" data-title="Axioms of `pq-System`">

    <p>\(x\vect{p}\text{-}\vect{q}x\text{-}\) is an axiom, whenever \(x\) is composed of only ‘\(\text{-}\)’s.</p>

  </div>

  <p>Given this, you should be able to verify that
\(\text{-}\text{-}\vect{p}\text{-}\vect{q}\text{-}\text{-}\text{-}\) is an axiom
of the system (=a well-formed expression).</p>

  <p>There is only one rule of production:</p>

  <div class="item" id="def:pq-production" data-kind="definition" data-label="Definition" data-title="Productions of `pq-System`">

    <p>If \(x\vect{p}y\vect{q}z\) is a well-formed expression, again with \(x,y,z\) all composed of zero or more ‘\(\text{-}\)’s, then so is \(x\vect{p}y\text{-}\vect{q}z\text{-}\).</p>

  </div>

  <p>Now. think of a <strong>decision procedure</strong> that takes an expression and decides
whether it is well-formed or not.</p>

  <hr class="topic-separator" />

  <p>Inspecting the well-formed expressions of <code class="language-plaintext highlighter-rouge">pq-System</code>, can you see what do they
<em>mean</em>? Or, can you say what they are <em>about</em>? Or, can you say what they are
<em>for</em>?</p>

  <p>They are theorems of binary addition of non-equal (except \(1 + 1 = 2\)) and non-negative integers. Their
<em>meaning</em> is this.</p>

  <h3 id="levels-of-analysis">Levels of analysis</h3>

  <p>Language is studied in levels of analysis. The study of the atomic building
blocks of language and how they combine into more complex structures is called
<strong>phonology</strong>. The alphabet analogy, although the best we can do, would be a little
misleading here, because the building blocks of language are not the
orthographic symbols, but the <strong>phonemes</strong>, the smallest units of sound that can
distinguish meaning in a language.</p>

  <p>The study of the properties of well-formed expressions is called
<strong>morphosyntax</strong>. As you observed above, this can be studied without any
reference to meaning or significance in any form.</p>

  <p>The study of the meaning of expressions is called <strong>semantics</strong>. And again as
you saw above, what we mean by “meaning” is not obvious at all. What sort of a
relation is it? Correspondence, aboutness, use (procedural)? If it’s a
correspondence, what is the nature of the entities that are related? Are they
mental, neural, abstract? All these, and many more, are part of the game in the
study of natural language meaning.</p>

  <p>The last level that is interest to cognitive science is <strong>pragmatics</strong>, the
study of how language is used in context. The boundary between semantics and
pragmatics is not clear, and there are many different views on how to draw it.
As we go along, we will see that there might not be much value in drawing such
a boundary. Perhaps some boundaries are more useful when they are left fuzzy.</p>

  <p>In studying language from a cognitive science perspective, studying morphosyntax
on its own does not make much sense.<sup id="fnref:2"><a href="#fn:2" class="footnote" rel="footnote" role="doc-noteref">2</a></sup> The relevant field of inquiry is rather
the study of the relation between morphosyntax on one hand, and semantics and
pragmatics on the other. Let’s call this domain <strong>semantax</strong> for the sake of
having a name for it.<sup id="fnref:3"><a href="#fn:3" class="footnote" rel="footnote" role="doc-noteref">3</a></sup></p>

  <h3 id="grammar">Grammar</h3>

  <p>Some important aspects of human language are:</p>

  <ol>
    <li><strong>Compositionality:</strong> “The meaning of a compound expression is a function of
the meanings of its parts and of the way they are syntactically
combined.”<sup id="fnref:partee"><a href="#fn:partee" class="footnote" rel="footnote" role="doc-noteref">4</a></sup> This is usually cited as <strong>Frege’s principle</strong>. Fodor and
Lepore has a nice way to put it: You cannot understand <em>John loves Mary</em>
without also understanding <em>Mary loves John</em>.</li>
    <li><strong>Recursion:</strong> In principle, there is no end to the expressions that can be generated
   in a language. This is due to the fact that expressions of a given type
   can be (directly or indirectly) inserted in expressions of the same type.</li>
    <li>
      <p><strong>Structure dependence:</strong> For physical constraints, language is produced in a
linear fashion (you can speak one word at a time). But the meaning is “read
off” from the hierarchical structure. A necessary consequence of this is that
items that are related at the meaning level may find themselves fallen apart
on the actual acoustic/visual signal. Take:</p>

      <div class="item" id="ex:telescope" data-kind="definition" data-label="Example" data-title="The telescope sentence">
        <p>I saw the man with the telescope.</p>
      </div>

      <p>The sentence can mean two different things: (1) the speaker has the telescope, or (2)
the man has the telescope. The two meanings are determined by the hierarchical
structure of the expression: in (2) <code class="language-plaintext highlighter-rouge">the telescope</code> is
attached to <code class="language-plaintext highlighter-rouge">the man</code>, in (1), to <code class="language-plaintext highlighter-rouge">saw</code>.</p>
    </li>
  </ol>

  <p>In a very broad sense, a <strong>grammar</strong> regulates the correspondence between form
and meaning in a way that manifests the three properties above.</p>

  <p>When we talk about <strong>syntactic structure</strong>, we mean a particular organisation of
the components of an expression. For instance the two meanings of the telescope
sentence are related to the following (fairly simplified) structures:</p>

  <div class="item" id="ex:telescope-structures" data-kind="definition" data-label="Example" data-title="Two structures for the telescope sentence">
    <ol>
      <li>[I [saw [the man [with the telescope]]]]</li>
      <li>[I [[saw [the man]] [with the telescope]]]</li>
    </ol>
  </div>

  <p>Another way of thinking about structure, which is more transparent to semantics,
is to think of it as a particular organization of operators and arguments,
like we do in arithmetic.</p>

\[((3 + 4) \times 5)\]

  <p>When we go from the linear string of symbols \(((3 + 4) \times 5)\) to its
meaning, which is the value of the expression (=35), we work out the structure
of the expression in such a way that the <strong>operator</strong> +  is applied to its
<strong>arguments</strong> 3 and 4, and then the operator \(\times\) is applied to its
arguments, which are, 7, the value of the first operation (recursion!), and 5.</p>

  <p>Similarly, for the telescope example, in one reading the operator <em>saw</em> takes as
arguments the subject <em>I</em> and the object <em>the man with the telescope</em>; and in
the other reading, the operator <em>saw</em> takes as its object argument the noun
phrase <em>the man</em>, rather than the entire phrase <em>the man with the telescope</em>;
and this time the operator <em>with</em> takes as arguments the noun <em>the telescope</em>
and the verb phrase <em>saw the man</em> as arguments.<sup id="fnref:ser"><a href="#fn:ser" class="footnote" rel="footnote" role="doc-noteref">5</a></sup></p>

  <h3 id="main-questions">Main questions</h3>

  <p>The  major research questions on the grammar<sup id="fnref:sense"><a href="#fn:sense" class="footnote" rel="footnote" role="doc-noteref">6</a></sup> are:</p>

  <ol>
    <li>How do we understand and produce language?</li>
    <li>How do we acquire the capacity to do so?</li>
    <li>How is our language capacity related to other cognitive capacities, such as
perception, planning, reasoning, etc.?</li>
    <li>How do these relate to our neural substance?</li>
  </ol>

  <h3 id="cognitive-science-of-language">Cognitive science of language</h3>

  <p>The above questions are studied in several fields. What distinguishes cognitive
science from fields like psychology and linguistics is its emphasis on the
computational modeling of the phenomena. Cognitive science, at least in how we
take it to mean in our institute, takes the mind to be an information processing
system, and therefore the best way to understand it is by building computational
models of the phenomena we are interested in, be it a processing question or a
learning question.</p>

  <p class="notice--warning"><strong>Warning:</strong> Some, or perhaps all, readings suggested below might be difficult at this
stage. There is no cure for this. There are no textbooks, which can be read in
a linear way.<sup id="fnref:strictly"><a href="#fn:strictly" class="footnote" rel="footnote" role="doc-noteref">7</a></sup> You need to have a couple of passes with low reception and come back
to them later.</p>

  <p>There are two closely related axes of tension in the field, which I think it
is better to open-mindedly meet them from the very start, before you find
yourself socialized<sup id="fnref:gazdar"><a href="#fn:gazdar" class="footnote" rel="footnote" role="doc-noteref">8</a></sup> into one camp or another.</p>

  <p>The first of these is the debate on the relevance of probability  (statistics
and information theory) to the study of language, particularly syntax. Chomsky
is widely considered, at times too crudely I think,  to be firmly on the “not
relevant” side of the debate. It is nevertheless true that probability is not
much popular in mainstream linguistics. But in cognitive science, the debate is
almost never on <em>whether</em> but <em>how</em> these fields are relevant for the scientific
study of language. For convenience, I will call this the <strong>probability
debate</strong>.<sup id="fnref:catogorist"><a href="#fn:catogorist" class="footnote" rel="footnote" role="doc-noteref">9</a></sup></p>

  <p>Another source of tension in the field concerns the relevance of data-driven
approaches like corpus linguistics, deep neural nets, machine learning,
statistical language models, etc. to the scientific study of language, which
seems to be going nuclear especially after the appearance of LLMs.  This debate
naturally comes intertwined with discussions on the goals of science, especially
the distinction between prediction and explanation. For convenience, I will call
this the <strong>data debate</strong>.</p>

  <ul>
    <li>I suggest to start with <a href="/p/chomsky-ss/" target="_blank" rel="noopener">Chomsky (1957)</a>.<sup id="fnref:ss-parts"><a href="#fn:ss-parts" class="footnote" rel="footnote" role="doc-noteref">10</a></sup>
This sets the frame of discussion for almost everything that follows, and
remarkably – considering its impact – requires almost no background.</li>
    <li>On how probability fits into the study of language:  <a href="/p/manning-prob/" target="_blank" rel="noopener">Manning (2003)</a> and
<a href="/p/jurafsky-psycho/" target="_blank" rel="noopener">Jurafsky (2003)</a>.</li>
    <li>Readings relevant for the both debates are <a href="/p/pereira/" target="_blank" rel="noopener">Pereira (2000)</a> and <a href="/p/lappin-shieber/" target="_blank" rel="noopener">Lappin and Shieber (2007)</a></li>
    <li><a href="/p/norvig-chomsky/" target="_blank" rel="noopener">Norvig (2011)</a> addresses the latest views of
Chomsky on the relevance of (statistical) language models to the study of
language. Although, Norvig’s reading of Chomsky’s “claims” are rather superficial,<sup id="fnref:calmer"><a href="#fn:calmer" class="footnote" rel="footnote" role="doc-noteref">11</a></sup>
I think it is still a good read.</li>
    <li>People sometimes use the term <strong>computational linguistics</strong> to differentiate the
scientific study of language through computational modeling from the engineering
field of NLP. But be warned that this is not a well-established terminology. See
<a href="/p/stanford-cl/" target="_blank" rel="noopener">Schubert (2020)</a><span aria-hidden="true">, 1-4</span> for a balanced view.</li>
    <li>For a taste of the data debate focused on deep neural networks: <a href="/p/pater-2019/" target="_blank" rel="noopener">Pater (2019)</a> and <a href="/p/rawski-heins/" target="_blank" rel="noopener">Rawski and Heins (2023)</a>.</li>
    <li><a href="/p/lake/" target="_blank" rel="noopener">Lake et al. (2017)</a> and the commentaries on it are a good place
  to get introduced to the data debate within the broader cognitive
  science.<sup id="fnref:data-debate-terms"><a href="#fn:data-debate-terms" class="footnote" rel="footnote" role="doc-noteref">12</a></sup></li>
    <li>Whenever you hit an unfamiliar linguistic concept or term, consult <a href="/p/bender-fundamentals/" target="_blank" rel="noopener">Bender (2022)</a>. This will work fine as a practical
reference book until you develop a more serious interest in linguistics and/or
go on with language research.</li>
  </ul>

</div>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1">
      <p>Douglas Hofstadter, <em>Gödel, Escher, Bach: An Eternal Golden Braid</em> (Basic Books, 1979), Ch. 2. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>The same does not apply to phonology, which is a very interesting field of study from a cognitive science perspective on its own. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p><a href="https://en.wikipedia.org/wiki/John_R._Ross">John R. Ross</a> offered the term “semantax”, but it seems it did not get caught on. <a href="https://homepages.inf.ed.ac.uk/steedman/">Mark Steedman</a> has a project named such, though. <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:partee">
      <p>Barbara Partee, “Compositionality”, in <em>Varieties of Formal Semantics</em>, 1984. <a href="#fnref:partee" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:ser">
      <p>I am wildly simplifying for the sake of discussion. <a href="#fnref:ser" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:sense">
      <p>I use the term grammar in a fairly broad sense as the totality of the system that mediates between form and meaning. The term has a well-defined technical sense in formal language theory and the theory (and applications) of parsing. <a href="#fnref:sense" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:strictly">
      <p>There actually <em>are</em>, but they are too opinionated. Also be warned about “handbook” entries that focus on the personal contributions of the author. <a href="#fnref:strictly" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:gazdar">
      <p>“Just a collection of buzz words whose appropriate use you are socialized into”, says <a href="https://nlp.fi.muni.cz/~xjakub/briscoe-gazdar/gpsg.html">Gerald Gazdar</a> describing his not so bright opinion about a particular version of Chomskyan generative grammar. <a href="#fnref:gazdar" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:catogorist">
      <p>Closely, related to this is the issue of categorical vs. gradient phenomena in language. <a href="#fnref:catogorist" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:ss-parts">
      <p>Chapters 1-4, 6, and 8. Chapter 9 is also of interest on Chomsky’s
take on syntax-semantics relation. <a href="#fnref:ss-parts" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:calmer">
      <p>Objectors of Chomsky on this count largely concentrate on his observation that the grammatical English sentence <em>Colorless green ideas sleep furiously</em> has zero probability on crude frequency based models without smoothing, which was the state-of-art at that date, and the corollary he draws from this fact that statistical regularity has no place in defining the notion of “grammatical sentence in language \(L\)”. Chomsky’s attitude toward the place of probability and statistics in language science is not as crude as his objectors appear to think. For instance, Norvig seems to have missed footnote 4 on p. 17 of <em>Syntactic Structures</em>, and his remarks on syntax, semantics, and language use in Chapter 9. See Chomsky’s preface to 1975 edition of <em>Logical Structure of Linguistic Theory</em>, p.3. Also see the other LSLT quotes in <a href="/p/yang-crunch/" target="_blank" rel="noopener">Yang (2008)</a> for a more accurate view on Chomsky’s stance on the subject. <a href="#fnref:calmer" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:data-debate-terms">
      <p>Useful terminology on the data debate are <a href="/p/lake/" target="_blank" rel="noopener">Lake et al. (2017)</a>’s <strong>pattern recognition</strong> vs. <strong>model building</strong>, and <a href="/p/softmax/" target="_blank" rel="noopener">Frank and Degen (2023)</a>’s <strong>input-output models</strong> vs <strong>internally meaningful models</strong>. <a href="#fnref:data-debate-terms" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name></name></author><category term="course" /><category term="language" /><category term="cogsci" /><summary type="html"><![CDATA[Initial steps for cognitive science students interested in language.]]></summary></entry><entry><title type="html">Assignment in lambda expressions</title><link href="https://umutozge.github.io/posts/course/walrus-operator/" rel="alternate" type="text/html" title="Assignment in lambda expressions" /><published>2026-02-12T00:00:00+03:00</published><updated>2026-02-12T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/walrus-operator</id><content type="html" xml:base="https://umutozge.github.io/posts/course/walrus-operator/"><![CDATA[<p>We closed the post <a href="/posts/course/more-state-power/">More state power</a> with a function that collects <code class="language-plaintext highlighter-rouge">n</code> random numbers between <code class="language-plaintext highlighter-rouge">start</code> and <code class="language-plaintext highlighter-rouge">end</code> into a list. Here is the function again:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">n_uniq_random</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return a list of n unique random numbers between start and end. </span><span class="sh">"""</span>

    <span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
    <span class="kn">from</span> <span class="n">funcutils</span> <span class="kn">import</span> <span class="n">proc</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]:</span>
            <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">return</span> <span class="nf">proc</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">:</span> <span class="p">[],</span> <span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                <span class="n">alive</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">,</span>
                <span class="n">update</span><span class="o">=</span><span class="n">update</span>
                <span class="p">)[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span>
</code></pre></div></div>

<p>If we wanted to send our <code class="language-plaintext highlighter-rouge">update</code> functions as a lambda expression, this would have been impossile because our function is full of assignments. One for the random number <code class="language-plaintext highlighter-rouge">x</code>, and two for updating the dictionary <code class="language-plaintext highlighter-rouge">s</code>. The <code class="language-plaintext highlighter-rouge">if</code> statement is also a problem, and we cannot turn it into an expression <code class="language-plaintext highlighter-rouge">if</code> since its arguments are assignments, not expressions.</p>

<p>Actually, dictionary key assignment is not a problem, because it is totally unnecessary. You can get rid of it by:<sup id="fnref:wrap"><a href="#fn:wrap" class="footnote" rel="footnote" role="doc-noteref">1</a></sup></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">count</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span>
</code></pre></div></div>

<p>Once you get rid of assignments inside the <code class="language-plaintext highlighter-rouge">if</code> statement, you can turn the <code class="language-plaintext highlighter-rouge">if</code> into an expression:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
    <span class="nf">return </span><span class="p">({</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="sh">'</span><span class="s">count</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span>
            <span class="k">else</span> <span class="n">s</span><span class="p">)</span>
</code></pre></div></div>

<p>In this solution you have to re-write the dictionary <code class="language-plaintext highlighter-rouge">s</code> you received as argument. It is fine for this case but this may be inefficient especially in cases where you have many keys in the state dictionary and you update only one or two of them. You will then have to write the whole dictionary again. Furthermore, imagine you have 3 conditions according to which you change a different key in the dictionary. You will then have to write the whole dictionary 3 times, once for each condition. This is tedious and, more importantly, error-prone.</p>

<p>Actually you do not have to write the entire dictionary. We can use the dictionary merging operator ‘<code class="language-plaintext highlighter-rouge">|</code>’ to create a new dictionary with the updated values instead of modifying the existing one in place. Here is how merge works:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">|</span> <span class="p">{</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>  <span class="c1"># new dictionary with 'b' mapped to 5
</span><span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="c1"># original dictionary remains unchanged
</span><span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">|</span> <span class="p">{</span><span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span><span class="mi">9</span><span class="p">}</span>  <span class="c1"># multiple changes in a single stroke 
</span><span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">|</span> <span class="p">{</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">}</span>  <span class="c1"># updating 'b' based on its previous value
</span><span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">|</span> <span class="p">{</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="sh">'</span><span class="s">e</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>  <span class="c1"># updates and additions
</span><span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="sh">'</span><span class="s">e</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
</code></pre></div></div>

<p>The update function above can be re-written, of course unnecessarily in this case, as:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">s</span> <span class="o">|</span> <span class="p">{</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="sh">'</span><span class="s">count</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span>
            <span class="k">else</span> <span class="n">s</span><span class="p">)</span>
</code></pre></div></div>

<p>This would work perfectly fine in a setting where there are other keys in your state dictionary which you want to leave untouched when updating <code class="language-plaintext highlighter-rouge">'uniq_nums'</code> and <code class="language-plaintext highlighter-rouge">'count'</code>.</p>

<p>Having handled dictionary manipulation without using assignment, what do we now do with the variable assignment <code class="language-plaintext highlighter-rouge">x = randint(start, end)</code>? We simply cannot do:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">s</span> <span class="o">|</span> <span class="p">{</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)],</span> 
                 <span class="sh">'</span><span class="s">count</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
            <span class="k">if</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span>
            <span class="k">else</span> <span class="n">s</span><span class="p">)</span>
</code></pre></div></div>

<p>since the two calls of <code class="language-plaintext highlighter-rouge">randint</code> will give different values. We need to store the value of <code class="language-plaintext highlighter-rouge">randint(start, end)</code> somewhere to use it twice.</p>

<p>Let’s simplify the problem a little bit. Suppose we want to write a function that generates a random integer between 1 and 10, and returns it if it is even, otherwise returns -1. Using assignment, we can write:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="k">def</span> <span class="nf">random_even</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Pick a random integer between start and end, and return it if even or -1 if odd.</span><span class="sh">"""</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div>

<p>If you want to write this as a lambda expression, we saw above that the following will not work:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="n">random_even</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="p">(</span><span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
                                  <span class="k">if</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
                                  <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>as this picks two different random numbers, one used for evenness check and other as return value.</p>

<p>As lambda expressions are expressions, it shouldn’t be hard to make sense of this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">))(</span><span class="mi">8</span><span class="p">)</span>
<span class="mi">8</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">))(</span><span class="mi">7</span><span class="p">)</span>
<span class="o">-</span><span class="mi">1</span>
</code></pre></div></div>

<p>Lambda expressions are simply names of functions, whenever you have a name <code class="language-plaintext highlighter-rouge">a</code> you can apply it to its argument <code class="language-plaintext highlighter-rouge">x</code> by <code class="language-plaintext highlighter-rouge">a(x)</code>. What we did above is exactly this.</p>

<p>I guess this also makes sense:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">))(</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="c1"># some return value according to the result of randint(1,10)
</span></code></pre></div></div>

<p>I couldn’t write the return value as it is random. But we know that the value returned by <code class="language-plaintext highlighter-rouge">randint</code> will be bound to <code class="language-plaintext highlighter-rouge">x</code> and used both in the test and the success expression. With all this in place, here is our <code class="language-plaintext highlighter-rouge">random_even</code> function as a lambda expression:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">random_even</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">))(</span><span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
</code></pre></div></div>

<p>And, here is our <code class="language-plaintext highlighter-rouge">update</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">update</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span>
                  <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="p">(</span><span class="n">s</span> <span class="o">|</span> <span class="p">{</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="sh">'</span><span class="s">count</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
                               <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span>
                               <span class="k">else</span> <span class="n">s</span><span class="p">))(</span><span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
</code></pre></div></div>

<p>Thankfully, the developers of Python have found a way to simplify this somewhat cumbersome syntax by introducing the “walrus operator” <code class="language-plaintext highlighter-rouge">:=</code>. Using this operator, you can perform assignments inside expressions. First, see it in action in <code class="language-plaintext highlighter-rouge">random_even</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">random_even</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="n">x</span> <span class="nf">if </span><span class="p">(</span><span class="n">x</span> <span class="p">:</span><span class="o">=</span> <span class="nf">random</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div>

<p>And here is our final <code class="language-plaintext highlighter-rouge">update</code> function using the walrus operator:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">update</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="p">(</span><span class="n">s</span> <span class="o">|</span> <span class="p">{</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="sh">'</span><span class="s">count</span><span class="sh">'</span> <span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>
            <span class="nf">if </span><span class="p">(</span><span class="n">x</span> <span class="p">:</span><span class="o">=</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="sh">'</span><span class="s">uniq_nums</span><span class="sh">'</span><span class="p">]</span>
            <span class="k">else</span> <span class="n">s</span><span class="p">)</span>
</code></pre></div></div>

<p>The walrus operator is not restricted to lambda expressions, you can use it in regular function as well. We will make good use of it when we deal with comprehensions.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:wrap">
      <p>From here on the code blocks of isolated <code class="language-plaintext highlighter-rouge">update</code> are meant to be placed inside <code class="language-plaintext highlighter-rouge">n_uniq_random</code> function. <a href="#fnref:wrap" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name></name></author><category term="course" /><category term="programming" /><category term="functional programming" /><category term="cogs501" /><category term="lambda" /><summary type="html"><![CDATA[We closed the post More state power with a function that collects n random numbers between start and end into a list. Here is the function again:]]></summary></entry><entry><title type="html">More state power</title><link href="https://umutozge.github.io/posts/course/more-state-power/" rel="alternate" type="text/html" title="More state power" /><published>2025-12-20T00:00:00+03:00</published><updated>2025-12-20T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/more-state-power</id><content type="html" xml:base="https://umutozge.github.io/posts/course/more-state-power/"><![CDATA[<p class="notice--warning"><strong>Prerequisites:</strong> <a href="/posts/course/state-power/">The power of the state</a> and <a href="/posts/course/way-of-lambda/">The way of lambda</a></p>

<p>We fortified our <code class="language-plaintext highlighter-rouge">proc_seq</code> with tuples to keep track of multiple state variables.  We scan through a sequence of numbers that proceeds according to a given rule, keeping track of various properties of the sequence, like what is the largest number seen so far according to a given criterion, or what is the sum of all numbers seen so far. We are able to scan through the sequence in pairs, triples, or more, and can keep record of multiple properties of the sequence. We can add as many state variables as we want, but these variables can hold only single values.</p>

<p>We are still unable to handle the task of mapping a positive integer to the Collatz sequence it seeds. To do that, we need a state variable that can hold a sequence of numbers, not just a single number. Lists exist for this purpose. Here is a brief interlude on lists.</p>

<hr class="topic-separator" />

<p>Construction and indexing of lists is similar to tuples:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># first element
</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>	<span class="c1"># fourth element
</span><span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># last element
</span><span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># all but the first element
</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</code></pre></div></div>

<p>Lists are <strong>mutable</strong>, meaning that we can change them <strong>in place</strong>. Here is how:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># insert 6 at index 2
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>  <span class="c1"># extend by another list
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</code></pre></div></div>

<p>Operations like <code class="language-plaintext highlighter-rouge">.insert</code>, <code class="language-plaintext highlighter-rouge">.extend</code>, <code class="language-plaintext highlighter-rouge">.append</code>, and so on, are not expressions. They do now have any return value, but have side-effects that modify the list in place. Operations like these cause too much pain in programs, causing errors usually very hard to detect. We are not fond of side-effects, we like expressions that return values. Here are the expression equivalents of the above operations:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="p">[</span><span class="mi">7</span><span class="p">]</span>  <span class="c1"># concatenation
</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>  <span class="c1"># insert 6 at index 2
</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>  <span class="c1"># extend by another list
</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</code></pre></div></div>

<p>As you see, the list <code class="language-plaintext highlighter-rouge">x</code> remains unchanged after these operations. To actually change <code class="language-plaintext highlighter-rouge">x</code>, you need to assign the result back to <code class="language-plaintext highlighter-rouge">x</code>; unless you do that the original list remains unchanged.</p>

<p>Finally, here are some useful  functions on lists:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># length of the list
</span><span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">x</span>  <span class="c1"># membership test
</span><span class="bp">True</span>
</code></pre></div></div>

<hr class="topic-separator" />

<p>Back to Collatz sequences. Here is how we can use lists to construct the sequence seeded by a positive integer \(n\):</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the Collatz sequence seeded by positive integer n.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">collatz_sequence</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">collatz_sequence</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
    <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="sh">"""</span>
    <span class="kn">from</span> <span class="n">collatz</span> <span class="kn">import</span> <span class="n">collatz</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span>
        <span class="n">n</span><span class="p">,</span>
        <span class="n">seq</span><span class="o">=</span><span class="n">collatz</span><span class="p">,</span>
        <span class="n">alive</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">update</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">store</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">store</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">],</span>
        <span class="n">init</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">)</span>
</code></pre></div></div>

<hr class="topic-separator" />

<p>The post <a href="/posts/course/state-power/">The power of the state</a> closed:</p>

<blockquote>
  <p>There still remains a limitation in our notion of state which cannot be overcome by increasing the memory of the store component. You will find  what it is in another post.</p>
</blockquote>

<p>Now is time to make good on our promise.</p>

<p>Our sequence processor <code class="language-plaintext highlighter-rouge">proc_seq</code> keeps the sequence variable <code class="language-plaintext highlighter-rouge">n</code> and the store variable <code class="language-plaintext highlighter-rouge">store</code> separate. This separation does no harm under the assumption that the next item in the sequence depends only on the current item through a function of the users’ choice, passed to <code class="language-plaintext highlighter-rouge">proc_seq</code> via the <code class="language-plaintext highlighter-rouge">seq</code> parameter. But what if the next item in the sequence depends, perhaps among other things, on some information kept in the <code class="language-plaintext highlighter-rouge">store</code> parameter?</p>

<p>For an instance, take the task of generating 10 random numbers between 1 and 100, such that no number appears twice in the generated sequence.
The update task should not be hard to come by:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lambda store, x: store + [x] if x not in store else store
</code></pre></div></div>

<p>But how will you know that you have generated 10 unique numbers, so that it is time to stop? All you can check with <code class="language-plaintext highlighter-rouge">alive</code> is the index parameter <code class="language-plaintext highlighter-rouge">n</code>. The problem is that <code class="language-plaintext highlighter-rouge">alive</code> and <code class="language-plaintext highlighter-rouge">update</code> cannot communicate. You might think this would work:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">unique_random_numbers</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return a list of n unique random numbers between 1 and 100.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">unique_random_numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
    <span class="sh">"""</span>
    <span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span>
        <span class="bp">None</span><span class="p">,</span>
        <span class="n">seq</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="n">alive</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">store</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">,</span>
        <span class="n">update</span><span class="o">=</span><span class="k">lambda</span> <span class="n">store</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">store</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">store</span> <span class="k">else</span> <span class="n">store</span><span class="p">,</span>
        <span class="n">init</span><span class="o">=</span><span class="p">[]</span>
    <span class="p">)</span>
</code></pre></div></div>

<p>but this will give an unbound variable error, because <code class="language-plaintext highlighter-rouge">store</code> is not defined in the scope of <code class="language-plaintext highlighter-rouge">alive</code>. <code class="language-plaintext highlighter-rouge">alive</code> is a parameter of <code class="language-plaintext highlighter-rouge">proc_seq</code>, and parameters cannot refer to variables in the body of the function, it works just the other way round.</p>

<p>There is only one way out of this impasse.<sup id="fnref:ditch"><a href="#fn:ditch" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> You need a more powerful state, but this time the extra power does not come from memory capacity but the structure of the state. A more general state architecture opens the way to more flexible communication between state parameters.</p>

<p>We had very hard time to get used to <code class="language-plaintext highlighter-rouge">proc_seq</code>, and I guess, or hope, some of us has even started to like it, a bit. But it is time to say “good bye” to <code class="language-plaintext highlighter-rouge">proc_seq</code>. From here on we will have <code class="language-plaintext highlighter-rouge">proc</code>, which makes use of a single state variable that can be structured and manipulated in full flexibility:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">proc</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Process as succession of states.

    state: initial state
    alive: one-place function that tests whether state is alive
    update: function that updates the state
    </span><span class="sh">"""</span>
    <span class="k">while</span> <span class="nf">alive</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nf">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">state</span> 
</code></pre></div></div>

<p>Let’s have an example.</p>

<p>Return a list of <code class="language-plaintext highlighter-rouge">n</code> unique random numbers each between <code class="language-plaintext highlighter-rouge">start</code> and <code class="language-plaintext highlighter-rouge">end</code>. To tackle the problem, we need to design our state and how to update it. The design is fairly simple when we operate with a single state that serves as argument to both <code class="language-plaintext highlighter-rouge">alive</code> and <code class="language-plaintext highlighter-rouge">update</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">n_uniq_random</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return a list of n unique random numbers between start and end.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">random</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">n_uniq_random_dict</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="sh">"""</span>
    <span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
    <span class="kn">from</span> <span class="n">funcutils</span> <span class="kn">import</span> <span class="n">proc</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nf">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">else</span> <span class="n">s</span>

    <span class="k">return</span> <span class="nf">proc</span><span class="p">(</span><span class="n">state</span><span class="o">=</span> <span class="p">[],</span>
                <span class="n">alive</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">,</span>
                <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">)</span>
</code></pre></div></div>

<hr class="topic-separator" />

<p>Let’s get back to the <a href="/cogs501/posts/course/state-power/#ref:turning_point">problem</a> of counting the turning points in the Collatz sequence seeded by \(n\), and re-write it with <code class="language-plaintext highlighter-rouge">proc</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_turning_points</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the number of turning points in the Collatz sequence seeded by n.</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="n">state</span>
        <span class="nf">return </span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="nf">int</span><span class="p">(</span><span class="nf">turning_point</span><span class="p">(</span><span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">current</span><span class="p">)),</span>
                <span class="n">one_back</span><span class="p">,</span>
                <span class="n">current</span><span class="p">,</span>
                <span class="nf">collatz</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>

    <span class="k">return</span> <span class="nf">proc</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span>
                <span class="n">alive</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>Our state has 4 parameters in total and the meaning of each parameter depends on the position of the parameter in the 4-tuple. Even with 4 parameters, dealing with positions is error-prone. We are not good at remembering numbers. But we have no problem in understanding words. We will now see how to explicitly name our state parameters, through a brief interlude on dictionaries.</p>

<p>Dictionaries are mappings from <strong>keys</strong> to <strong>values</strong>. When we say mapping, we mean that each key is associated with one and only one value. Keys are usually strings, which can be formed by double or single quotes. Here is how to create and use dictionaries:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">[</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># value associated with key 'a'
</span><span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">[</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># change value associated with key 'b'
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">{</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
</code></pre></div></div>

<p>This much dictionary knowledge is enough for now.</p>

<hr class="topic-separator" />

<p>We can now re-write <code class="language-plaintext highlighter-rouge">collatz_turning_points</code> using a dictionary state:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_turning_points</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the number of turning points in the Collatz sequence seeded by n.</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="nf">proc</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">count</span><span class="sh">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="sh">"</span><span class="s">two_back</span><span class="sh">"</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span> <span class="sh">"</span><span class="s">one_back</span><span class="sh">"</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span> <span class="sh">"</span><span class="s">current</span><span class="sh">"</span><span class="p">:</span> <span class="n">n</span><span class="p">},</span>
                <span class="n">alive</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">"</span><span class="s">current</span><span class="sh">"</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">update</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="p">{</span><span class="sh">"</span><span class="s">count</span><span class="sh">"</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">"</span><span class="s">count</span><span class="sh">"</span><span class="p">]</span> <span class="o">+</span> <span class="nf">int</span><span class="p">(</span><span class="nf">turning_point</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="sh">"</span><span class="s">two_back</span><span class="sh">"</span><span class="p">],</span>
                                                                            <span class="n">s</span><span class="p">[</span><span class="sh">"</span><span class="s">one_back</span><span class="sh">"</span><span class="p">],</span>
                                                                            <span class="n">s</span><span class="p">[</span><span class="sh">"</span><span class="s">current</span><span class="sh">"</span><span class="p">])),</span>
                                   <span class="sh">"</span><span class="s">two_back</span><span class="sh">"</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">"</span><span class="s">one_back</span><span class="sh">"</span><span class="p">],</span>
                                   <span class="sh">"</span><span class="s">one_back</span><span class="sh">"</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="sh">"</span><span class="s">current</span><span class="sh">"</span><span class="p">],</span>
                                   <span class="sh">"</span><span class="s">current</span><span class="sh">"</span><span class="p">:</span> <span class="nf">collatz</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="sh">"</span><span class="s">current</span><span class="sh">"</span><span class="p">])})[</span><span class="sh">"</span><span class="s">count</span><span class="sh">"</span><span class="p">]</span>
</code></pre></div></div>

<p>You may find this too wordy in comparison to the tuple based solution. In the tuple version it is more likely that the indices get jammed. More importantly that sort of errors are hard to detect, as they might not cause an error during execution. Making errors in dictionary keys will be more likely to be detected by the interpreter, as “key not found” errors. But in the end, all this depends on the complexity of the problem/solution at hand. In sum, if wordiness pays back, be wordy, if it does not, go with the more concise tuple strategy.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:ditch">
      <p>Two actually; you can also ditch <code class="language-plaintext highlighter-rouge">proc_seq</code> and shift to a <code class="language-plaintext highlighter-rouge">while</code> loop solution, but not in this course, sorry. <a href="#fnref:ditch" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name></name></author><category term="course" /><category term="programming" /><category term="dictionary" /><category term="lists" /><summary type="html"><![CDATA[State unfied into a single parameter, dictionaries introduced.]]></summary></entry><entry><title type="html">The way of lambda</title><link href="https://umutozge.github.io/posts/course/way-of-lambda/" rel="alternate" type="text/html" title="The way of lambda" /><published>2025-12-12T00:00:00+03:00</published><updated>2025-12-12T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/way-of-lambda</id><content type="html" xml:base="https://umutozge.github.io/posts/course/way-of-lambda/"><![CDATA[<p>When I say “Call a plumber”, you need to know the meaning of “plumber” and “call”, and enough English syntax to be able to execute the command. In case you know what “call” means but not “plumber”, you consult a dictionary before you are ready to execute the command. I could have also said “Call someone who installs, repairs, and maintains piping, fittings, and fixtures involved in the distribution and use of water in a building”, substituting the Merriam-Webster definition of “plumber” for the word itself. This would save you the dictionary lookup.</p>

<p>Let’s define a function <code class="language-plaintext highlighter-rouge">fmax(x,y,f)</code> which picks <code class="language-plaintext highlighter-rouge">x</code> or <code class="language-plaintext highlighter-rouge">y</code> according for which <code class="language-plaintext highlighter-rouge">f</code> returns the larger value:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">f</span><span class="p">):</span>
  <span class="sh">"""</span><span class="s">Return x, if f(x) &gt; f(y), else, return y</span><span class="sh">"""</span>
  <span class="k">if</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">y</span>
</code></pre></div></div>

<p>And now assume you somehow needed to call <code class="language-plaintext highlighter-rouge">fmax</code> – you never know – and the function at your hand is \(f(x)=x^2 - 2x + 1\). The “plumber” way is to first define your function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">hard_to_name</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></div>

<p>and then call <code class="language-plaintext highlighter-rouge">fmax</code> passing the name of your function as the third parameter:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nf">fmax</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">hard_to_name</span><span class="p">)</span>
<span class="mf">0.001</span>
</code></pre></div></div>

<p>The Merriam-Webster way on the other hand is passing a “name” that tells what the function does:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nf">fmax</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="mf">0.001</span>
</code></pre></div></div>

<p>Here is how <code class="language-plaintext highlighter-rouge">def</code> and <code class="language-plaintext highlighter-rouge">lambda</code> are related:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="err">&lt;</span><span class="nf">function_name</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="n">arg_1</span><span class="o">&gt;</span><span class="p">,...,</span><span class="o">&lt;</span><span class="n">arg_n</span><span class="o">&gt;</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span> 
</code></pre></div></div>

<p>is equivalent to</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">lambda</span> <span class="o">&lt;</span><span class="n">arg_1</span><span class="o">&gt;</span><span class="p">,...,</span><span class="o">&lt;</span><span class="n">arg_n</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>in the sense that in any program, wherever you can have <code class="language-plaintext highlighter-rouge">&lt;function_name&gt;</code>, you can have <code class="language-plaintext highlighter-rouge">lambda &lt;arg_1&gt;,...,&lt;arg_n&gt;: &lt;expression&gt;</code> instead, without changing anything in the behavior of the program. In defining a function with <code class="language-plaintext highlighter-rouge">lambda</code> we by-pass the naming step, or from a more illuminating angle, the definition itself becomes the name.<sup id="fnref:anon"><a href="#fn:anon" class="footnote" rel="footnote" role="doc-noteref">1</a></sup></p>

<p>So far in our programming tasks, when we needed small functions like adding 1 to its argument, checking whether the argument is negative, etc., we were defining these functions by <code class="language-plaintext highlighter-rouge">def</code> under a name, and using these names in higher order calls like in <code class="language-plaintext highlighter-rouge">proc_seq</code>. From now on, we will instead use <code class="language-plaintext highlighter-rouge">lambda</code> functions in such cases. For instance when you want to pass to <code class="language-plaintext highlighter-rouge">proc_seq</code> an <code class="language-plaintext highlighter-rouge">update</code> function that updates the store by adding the square of the current value, you will not need to define it by <code class="language-plaintext highlighter-rouge">def</code>, but rather will pass <code class="language-plaintext highlighter-rouge">lambda store, x: store + x*x</code> as the <code class="language-plaintext highlighter-rouge">update</code> argument. <code class="language-plaintext highlighter-rouge">lambda</code> functions are marvels of convenience in this sense, they save you from naming small functions with very local use, and saves the reader from the burden of searching the definition of the function, as s/he already has the definition in front of his/her eyes.</p>

<p>Besides passing them as arguments to other functions, you can also apply <code class="language-plaintext highlighter-rouge">lambda</code> functions to their arguments as you do with <code class="language-plaintext highlighter-rouge">def</code>ed functions. For instance, you can have:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)(</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">5</span>
</code></pre></div></div>

<p>You can assign them to names:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span>
<span class="o">&lt;</span><span class="n">function</span> <span class="o">&lt;</span><span class="k">lambda</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x104915a60</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">5</span>
</code></pre></div></div>

<p>and just like names of a <code class="language-plaintext highlighter-rouge">def</code>ed function, <code class="language-plaintext highlighter-rouge">lambda</code> functions are expressions that evaluate to the function itself:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mi">2</span>
<span class="o">&lt;</span><span class="n">function</span> <span class="o">&lt;</span><span class="k">lambda</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x1049159d0</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>By this last token, we will use the term “lambda expression” instead of “<code class="language-plaintext highlighter-rouge">lambda</code> function”, to emphasize that they are expressions that evaluate to functions.</p>

<hr class="topic-separator" />

<p>As you might have noticed from the equivalence above, lambda expressions differ from <code class="language-plaintext highlighter-rouge">def</code>ed functions not only in lacking explicit names. They also have no room for statements. All you can have to the right of <code class="language-plaintext highlighter-rouge">=</code> in a lambda expression is just an expression, i.e. a stretch of code that gets evaluated to a value. This restriction means you cannot have <code class="language-plaintext highlighter-rouge">if</code>, <code class="language-plaintext highlighter-rouge">while</code>, assignment (<code class="language-plaintext highlighter-rouge">=</code>), <code class="language-plaintext highlighter-rouge">return</code>, etc., statements in a lambda expression.</p>

<p>At this point you may revolt that how can we compute beyond simple arithmetic without having <code class="language-plaintext highlighter-rouge">if</code>? How can we make decisions in a lambda expression?</p>

<p>I didn’t say we cannot have <code class="language-plaintext highlighter-rouge">if</code> in a lambda expression, I said we cannot have <code class="language-plaintext highlighter-rouge">if</code> <em>statements</em>.  We can perfectly have <code class="language-plaintext highlighter-rouge">if</code> <em>expressions</em>. In schematic form:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">success_expression</span><span class="o">&gt;</span> <span class="k">if</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span> <span class="k">else</span> <span class="o">&lt;</span><span class="n">failure_expression</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>is an expression that evaluates to <code class="language-plaintext highlighter-rouge">&lt;success_expression&gt;</code> if <code class="language-plaintext highlighter-rouge">&lt;condition&gt;</code> evaluates to true, and to <code class="language-plaintext highlighter-rouge">&lt;failure_expression&gt;</code> otherwise. Here is a lambda expression that defines our <code class="language-plaintext highlighter-rouge">fmax</code> above:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">else</span> <span class="n">y</span>
</code></pre></div></div>

<p>As we go along, we will see the ways to do without all sorts of statements for looping, assignment, and so on. 
Statements are toxic to your programs, you need to learn to avoid them as much as possible. Lambda is a good tool for learning this art. A healthy function is the one that can be written as a lambda expression. You do not have to write your functions as lambda expressions all the time, but do your best to ensure that they are writable as such. This is the essence of the “lambda way” of programming.</p>

<hr class="topic-separator" />

<p>Church’s Lambda Calculus, where Python’s lambda’s are coming from, is a much deeper subject than we were able to have here. The appreciation of this depth has some prerequisites which we lack for now. So let’s leave it for a future occasion to be tackled by those who are interested in subjects like theory of computation, advanced functional programming, foundations of logic and mathematics, and so on.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:anon">
      <p>Sometimes <code class="language-plaintext highlighter-rouge">lambda</code> functions are called <em>anonymous functions</em> in the “unnamed” sense of the word. I rather find taking the definition itself as the “name” more illuminating. <a href="#fnref:anon" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name></name></author><category term="course" /><category term="programming" /><category term="lambda" /><category term="if expression" /><category term="funprog" /><summary type="html"><![CDATA[An introduction to lambda expressions in Python and their use in (functional) programming.]]></summary></entry><entry><title type="html">The power of the state</title><link href="https://umutozge.github.io/posts/course/state-power/" rel="alternate" type="text/html" title="The power of the state" /><published>2025-12-06T00:00:00+03:00</published><updated>2025-12-06T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/state-power</id><content type="html" xml:base="https://umutozge.github.io/posts/course/state-power/"><![CDATA[<p>Computation can be thought of as a sequence of states, where there is a meaningful relation between the initial and the final state. Think of summing the first \(n\) positive integers. One strategy is to start with an empty store (or accumulator), and (i) either adding \(n\), then \(n-1\), and so on, to the store until you reach 1; or (ii) adding 1, then 2, and so on, to the store until you reach \(n\), and returning the store at the end.</p>

<p>There is a cyclic pattern in this computation. In each cycle the values of \(n\) and  \(store\) change, while the method of computing the next number in the sequence (increasing or decreasing by 1) and the condition on when to stop (\(= 1\) or \(=n\) ) stay constant.</p>

<p>Assume we started the above procedure on number 70. There will be 70 steps in total, until we get the result. Now assume you interrupt the procedure at some point, say after 30 cycles. All the information that you need to be able to continue from there on until the end and return the correct result is called the “state” of the computation at the point of your interruption. In this case, the state consists of the current value of \(n\), the current value of \(store\), how to compute the next number in sequence, and when to stop. The previous values of \(n\) and \(store\) are not relevant, and therefore are not part of the state. We will sometimes use the term “state” to refer only to the parts that may change from cycle to cycle, in this case the current values of \(n\) and \(store\).</p>

<p>Now, a slightly more complicated problem: finding the \(n\)th <a href="/exercises/iteration/#fibonacci-def">Fibonacci number</a>. In computing the Fibonacci numbers in a bottom-up iterative manner, we need to keep track of the two previous Fibonacci numbers in order to compute the next one. Therefore, the state of this computation consists of three parts: the current index in the sequence, and the two previous Fibonacci numbers.</p>

<p>You’ve already solved this problem using a <code class="language-plaintext highlighter-rouge">while</code> loop. What about solving it using <code class="language-plaintext highlighter-rouge">proq_seq</code> from <a href="/code/python/modules/funcutils/"><code class="language-plaintext highlighter-rouge">funcutils</code></a>?</p>

<p>So far, <code class="language-plaintext highlighter-rouge">proc_seq</code> has been useful in solving problems where in each cycle you were updating the store which could hold a single number: a sum, max value, and so on. But Fibonacci calls for keeping track of two numbers. This was not a problem in the <code class="language-plaintext highlighter-rouge">while</code> loop version since you could name the numbers (e.g. <code class="language-plaintext highlighter-rouge">prev</code> and <code class="language-plaintext highlighter-rouge">curr</code>).</p>

<p>This brings us to the point where you need a more powerful state. Power in this context means a more sophisticated memory. We will expand our power by introducing the data structure <code class="language-plaintext highlighter-rouge">tuple</code>. Tuples are formed by the comma operator, and tuple components are accessed by indexing which starts from 0. Here is how:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># A tuple with two components
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># Tuple concatenation
</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="c1"># A 4-tuple created without parentheses
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">k</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># IndexError: tuple index out of range
</span></code></pre></div></div>

<p>Equipped with  tuples, we can now solve the Fibonacci problem using <code class="language-plaintext highlighter-rouge">proc_seq</code>.</p>

<p>Try before proceeding.</p>

<p>Here is the solution:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the n-th Fibonacci number (n&gt;=1).
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="mi">0</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="mi">1</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="mi">13</span>
    <span class="sh">"""</span>
    <span class="kn">from</span> <span class="n">funcutils</span> <span class="kn">import</span> <span class="n">proc_seq</span>
    <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">n</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="nf">return </span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>  
</code></pre></div></div>

<p>A couple of notes:</p>
<ol>
  <li>Now our store is a tuple of two integers, holding the two previous Fibonacci numbers.</li>
  <li>Initializing the store to (-1, 1) is a trick to make the first update produce (1, 0) which corresponds to the first Fibonacci number, and the second update to produce (0,1) as the second Fibonacci number.</li>
  <li>In the end, we return the <em>second</em> component of the store which holds the \(n\)th Fibonacci number.</li>
</ol>

<hr class="topic-separator" />

<p>Let’s get back to <a href="/posts/course/iteration-by-while">collatz business</a> for some more fun. First let’s fix some imports for ourselves:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">collatz</span> <span class="kn">import</span> <span class="n">collatz</span>
<span class="kn">from</span> <span class="n">funcutils</span> <span class="kn">import</span> <span class="n">proc_seq</span>
</code></pre></div></div>

<p>When we were asked to find the largest integer visited in the sequence seeded by <code class="language-plaintext highlighter-rouge">n</code> we could solve this problem by:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">largest_in_collatz_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the largest integer in the Collatz sequence seeded by n. </span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p id="ref:turning_point">Now, assume we are interested in the number of times we change “direction” in a Collatz sequence seeded by \(n\). That is, how many triples of consecutive numbers \((a,b,c)\) are there in the sequence such that \((a &gt; b \land b &lt; c) \lor (a &lt; b \land b &gt;c)\)? Let’s think. What do we have to keep the record of in each iteration to be able to count the direction changes? In each cycle I receive a new number; to be able to tell whether this causes a change in direction, I need to know the previous two numbers. Therefore, my store must hold three numbers: the previous two numbers and the current count of direction changes. Let us first agree on an order. Let the first component of the store be the count, the second two-back, and the third one-back. Now we can write the code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the number of direction changes in the Collatz sequence seeded by n.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="mi">0</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
    <span class="mi">9</span>
    <span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="nf">if </span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">new</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">new</span><span class="p">):</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">store</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">new</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span>
                    <span class="n">collatz</span><span class="p">,</span>
                    <span class="n">alive</span><span class="p">,</span>
                    <span class="n">update</span><span class="p">,</span>
                    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="c1"># ensure no direction change before the third number
</span>                    <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>but we mustn’t. This is too hard to read, it takes to be a genius to understand what the <code class="language-plaintext highlighter-rouge">update</code> is doing, so do not even attempt to understand it, unless you are one.</p>

<p>Let’s try to bring some order into this chaos by naming the components of the store in the definition of <code class="language-plaintext highlighter-rouge">update</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the number of direction changes in the Collatz sequence seeded by n. </span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span> <span class="o">=</span> <span class="n">store</span> <span class="c1"># yes, you can unpack a tuple like this
</span>        <span class="nf">if </span><span class="p">(</span><span class="n">two_back</span> <span class="o">&lt;</span> <span class="n">one_back</span> <span class="ow">and</span> <span class="n">one_back</span> <span class="o">&gt;</span> <span class="n">new</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">two_back</span> <span class="o">&gt;</span> <span class="n">one_back</span> <span class="ow">and</span> <span class="n">one_back</span> <span class="o">&lt;</span> <span class="n">new</span><span class="p">):</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>This looks better, I think. But I find it very hard to read long lines. Let’s break the <code class="language-plaintext highlighter-rouge">if</code> condition into multiple lines. The best way to brake such long lines is to wrap the entire condition expression in parentheses, and when this is done, you can break it anywhere inside the parentheses:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the number of direction changes in the Collatz sequence seeded by n. </span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span> <span class="o">=</span> <span class="n">store</span>
        <span class="nf">if </span><span class="p">((</span><span class="n">two_back</span> <span class="o">&lt;</span> <span class="n">one_back</span> <span class="ow">and</span> <span class="n">one_back</span> <span class="o">&gt;</span> <span class="n">new</span><span class="p">)</span>
            <span class="ow">or</span> 
            <span class="p">(</span><span class="n">two_back</span> <span class="o">&gt;</span> <span class="n">one_back</span> <span class="ow">and</span> <span class="n">one_back</span> <span class="o">&lt;</span> <span class="n">new</span><span class="p">)):</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>Note that this “parenthesize and divide” strategy works for expressions in general.</p>

<p>This is much better. Now, I can read and understand what is going on in the <code class="language-plaintext highlighter-rouge">update</code> function without too much effort.
But still, this logic of direction change looks a little obtruding (either check the dictionary for “obtruding”, or assume I said “ugly”). The reason is that it violates the principle of “doing one thing at a time” in a function. Let’s outsource this logic to a separate function. Let’s also make it somewhat more clever, or, perhaps, more beautiful. Doing many logical operations does not look nice, does it? Given three numbers, is there an arithmetic way to decide whether there is a directional change or not?</p>

<p>Try before proceeding.</p>

<p>Here is my take, perhaps yours was better:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">turning_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Retrurn True if y is a turning_point from increasing to decreasing
       or vice versa.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">turning_point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="bp">False</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">turning_point</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">False</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">turning_point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">True</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">turning_point</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">True</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">turning_point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="bp">False</span>
    <span class="sh">"""</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
</code></pre></div></div>

<p>With this function, we can simplify the <code class="language-plaintext highlighter-rouge">update</code> function in <code class="language-plaintext highlighter-rouge">collatz_direction_changes</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the number of direction changes in the Collatz sequence seeded by n. </span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span> <span class="o">=</span> <span class="n">store</span>
        <span class="k">if</span> <span class="nf">turning_point</span><span class="p">(</span><span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>Well, you guessed it right, we are not done yet.</p>

<p>Let me tell you something useful. You can <strong>type-cast</strong> booleans to integers by applying the built-in <code class="language-plaintext highlighter-rouge">int</code> to any boolean expression. <code class="language-plaintext highlighter-rouge">True</code>, <code class="language-plaintext highlighter-rouge">2&gt;1</code>, etc., becomes 1 and <code class="language-plaintext highlighter-rouge">False</code>, <code class="language-plaintext highlighter-rouge">2&lt;1</code>, etc., becomes 0.<sup id="fnref:bool"><a href="#fn:bool" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> Therefore, in incrementing the count according whether you observed a turning point or not, you do not even need an <code class="language-plaintext highlighter-rouge">if</code> statement. You can write:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_direction_changes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the number of direction changes in the Collatz sequence seeded by n.</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span> <span class="o">=</span> <span class="n">store</span>
        <span class="nf">return </span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="nf">int</span><span class="p">(</span><span class="nf">turning_point</span><span class="p">(</span><span class="n">two_back</span><span class="p">,</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)),</span> <span class="n">one_back</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>That’s the beauty of working with expressions. If the issue is adding 1 to a variable if a certain condition holds and adding 0 if it does not, then simply put an expression that would evaluate to 1 or 0 according to the condition after the <code class="language-plaintext highlighter-rouge">+</code> operator. At this point it is enough that you understand why this works. Later on, as more and more practice, you will start seeing such opportunities by yourself.</p>

<hr class="topic-separator" />

<p>We have a small computer which we called <code class="language-plaintext highlighter-rouge">proc_seq</code>. We were happily (??) solving various problems with it until we realized that its store component can hold only a single number. By enhancing the memory of the store to hold tuples, we were able to solve more complex problems,
as we were able to keep track of multiple pieces of information in each cycle of our computations. We used this technology to solve more complex problems like computing Fibonacci numbers and counting direction changes in Collatz sequences. There still remains a limitation in our notion of state which cannot be overcome by increasing the memory of the store component. You will find what it is in another post.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:bool">
      <p>You can map 0 and 1 to <code class="language-plaintext highlighter-rouge">False</code> and <code class="language-plaintext highlighter-rouge">True</code> respectively by applying the built-in <code class="language-plaintext highlighter-rouge">bool</code> to them. Actually <code class="language-plaintext highlighter-rouge">bool</code> returns <code class="language-plaintext highlighter-rouge">True</code> for any integer other than 0. <a href="#fnref:bool" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name></name></author><category term="course" /><category term="programming" /><category term="tuples" /><summary type="html"><![CDATA[The notion of state and how to enhance its memory power by tuples.]]></summary></entry><entry><title type="html">Euclid’s Algorithm</title><link href="https://umutozge.github.io/posts/course/euclids-algorithm/" rel="alternate" type="text/html" title="Euclid’s Algorithm" /><published>2025-11-24T00:00:00+03:00</published><updated>2025-11-24T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/euclids-algorithm</id><content type="html" xml:base="https://umutozge.github.io/posts/course/euclids-algorithm/"><![CDATA[<p class="notice--warning"><strong>Check:</strong> Make sure you are fine with <a href="/blog/intro-number-theory">very basic number theory</a>.</p>

<blockquote class="mathbox definition" id="def:gcd">
  <p><strong>Definition</strong> (greatest common divisor) <br /><br />
Given two integers \(a\) and \(b\), the <strong>greatest common divisor</strong> (GCD) of \(a\) and \(b\), denoted by \(\gcd(a,b)\), is the largest integer that divides both \(a\) and \(b\).</p>
</blockquote>

<p>Euclid’s algorithm (300 BC) which computes the GCD of two positive integers is one of the oldest algorithms still useful today.</p>

<p>The algorithm for computing GCD of \(a\) and \(b\), where \(a&gt;b\):</p>
<ul>
  <li>To compute \(gcd(a,b)\):
    <ul>
      <li>Let \(r = a\bmod b\);</li>
      <li>if \(r = 0\), then the answer is \(b\).</li>
      <li>else, the answer is \(gcd(b,r)\).</li>
    </ul>
  </li>
</ul>

<p>This simple yet ingenious algorithm may not be easy to understand without examples.<sup id="fnref:euc"><a href="#fn:euc" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> Take the numbers 48 and 18.</p>

\[48 = 2 \times 18 + 12\]

<p>As the remainder is not 0, we repeat the process with 18 and 12:</p>

\[18 = 1 \times 12 + 6\]

<p>One more time with 12 and 6:</p>

\[12 = 2 \times 6 + 0\]

<p>As the remainder is now 0, we can stop. The GCD of 48 and 18 is therefore 6.</p>

<p>Another quick example: what is the GCD of 476 and 272? The answer is 68, as we can see from the following steps:</p>

\[\begin{align*}
476 &amp; = 1 \times 272 + 204 \\
272 &amp; = 1 \times 204 + 68 \\
204 &amp; = 3 \times 68 + 0
\end{align*}\]

<p>So much for <em>how</em> the algorithm works. But <em>why</em> does it work?</p>

<p>The critical observation is that the GCD of any \(a\) and \(b\), with \(a&gt;b\), is the same as the GCD of \(b\) and the remainder of dividing \(a\) by \(b\). In a concise and more formal way, we can state this as:</p>

\[\begin{align}
\forall a,b,r\in \mathbb{Z} \text{ s.t. } a&gt;b, gcd(a,b) = gcd(b,a \bmod b)
\label{gcdequal}
\end{align}\]

<p>Why is \eqref{gcdequal} true?</p>

<p>We will see two proofs of \eqref{gcdequal}, both correct. You decide which one is “better”.</p>

<blockquote class="mathbox proof" id="proof:gcd-euclid-1">
  <p><strong>Proof</strong> (\eqref{gcdequal}, version 1):<br />
Let’s say \(gcd(a,b)=g\), we want to show that \(gcd(b,r)=g\), where \(r=a \bmod b\).
We can think of this task as two sub-tasks: (1) show that \(g\) divides both \(b\) and \(r\), and (2) show that any other common divisor of \(b\) and \(r\) cannot be larger than \(g\).<br />
First part: <br /></p>
  <ol>
    <li>As \(gcd(a,b)=g\), then \(g\) divides both \(a\) and \(b\), and we can write \(a=mg\) and \(b=ng\) for some integers \(m,n\).<br /></li>
    <li>Let \(r=a \bmod b\), which means \(a=kb+r\), and therefore \(r=a-kb\) for some integer \(k\).<br /></li>
    <li>Replace \(a,b\) with \(mg,ng\) respectively in the equation for \(r\) to get \(r=mg-k(ng)=g(m-kn)\).<br /></li>
    <li>As \(m-kn\) is an integer, we can conclude that \(r\) is divisible by \(g\).<br /></li>
    <li>We already know that \(g\mid b\), therefore \(g\) is a common divisor of \(b\) and \(r\).<br /></li>
  </ol>

  <p>Second part:<br /></p>
  <ol>
    <li>Assume that there is another common divisor of \(b\) and \(r\), call it \(h\), where \(h &gt; g\).<br /></li>
    <li>First, \(h\nmid a\), because otherwise \(h\) becomes a common divisor of \(a\) and \(b\) larger than their GCD \(g\), which is a contradiction.<br /></li>
    <li>As \(h\) divides both \(b\) and \(r\), we can write \(b=ph\) and \(r=qh\) for some integers \(p,q\).<br /></li>
    <li>Replace \(b\) and \(r\) in the equation \(a=kb+r\) with \(ph\) and \(qh\), respectively. We get \(a=k(ph)+qh=h(kp+q)\), which in turn means \(h\mid a\), given that \(kp+q\) is guaranteed to be an integer. Again we contradicted ourselves.<br /></li>
    <li>Therefore \(b\) and \(r\) cannot have a common divisor larger than \(g\), completing the proof<br /></li>
  </ol>
</blockquote>

<p>Here is a slightly different proof. In this we will not proceed over the GCD of \(a\) and \(b\) directly, but prove that the set of common divisors of \(a\) and \(b\) is the same with the set of common divisors of \(b\) and \(r\). As the GCD is defined as the largest common divisor, if the two sets are the same, their GCDs must be the same as well.</p>

<blockquote class="mathbox proof" id="proof:gcd-euclid-2">
  <p><strong>Proof</strong> (\eqref{gcdequal}, version 2):<br />
Let \(A = \lbrace x: x\mid a, x\mid b \rbrace\) and \(B = \lbrace y: y\mid b, y\mid r \rbrace\) be the sets of common divisors of \(a\) and \(b\), and \(b\) and \(r\), respectively. We want to show that \(A = B\).<br />
First show \(A \subseteq B\):<br />
Pick any \(g\in A\), then by the exact same steps in the earlier proof, you deduce \(g\mid b\) and \(g\mid r\), and therefore \(g\in B\).<br />
Second show \(B \subseteq A\):<br />
Pick any \(h\in B\), then by the exact same steps in the earlier proof, you deduce \(h\mid a\) and \(h\mid b\), and therefore \(h\in A\).<br /></p>
</blockquote>

<p>In my opinion, there is an air of elegance in the second proof, in the sense that it does not resort to proof by contradiction.</p>

<p>Having proved \eqref{gcdequal},  we now know that we can reduce the problem of finding GCD of \(a\) and \(b\) to finding GCD of \(b\) and \(r\). To complete the picture for now, we will count on our intuition, without a rigorous proof,<sup id="fnref:converge"><a href="#fn:converge" class="footnote" rel="footnote" role="doc-noteref">2</a></sup> that repeating this process will eventually lead us to a remainder of 0, at which point the other number is the GCD.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:euc">
      <p>Even better are the visualizations you can find on Wikipedia. <a href="#fnref:euc" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:converge">
      <p>You need to show (1) that the remainders must decrease in each step, and (2) that they cannot go below 0; so eventually we must reach 0. <a href="#fnref:converge" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name></name></author><category term="course" /><category term="algorithms" /><category term="iteration" /><category term="proof" /><category term="discrete" /><category term="number theory" /><summary type="html"><![CDATA[Euclid's algorithm for finding the greatest common divisor of two integers and its partial proof.]]></summary></entry><entry><title type="html">Very basic number theory</title><link href="https://umutozge.github.io/posts/course/intro-number-theory/" rel="alternate" type="text/html" title="Very basic number theory" /><published>2025-11-24T00:00:00+03:00</published><updated>2025-11-24T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/intro-number-theory</id><content type="html" xml:base="https://umutozge.github.io/posts/course/intro-number-theory/"><![CDATA[<p>This is a healthy minimum dose of number theory to make you feel comfortable with the concepts we will be using in this course.</p>

<p>We do not start from the absolute beginning. We take for granted integers and arithmetic operations. We start by some terminology.
The set of integers, denoted by \(\mathbb{Z}\), is the set of whole numbers including negative numbers, zero, and positive numbers. When we say <strong>positive integers</strong> – aka <strong>natural numbers</strong> – we exclude zero and, obviously, negative integers. The set of positive integers is denoted by \(\mathbb{Z}^+\). If you want to include zero but leave out negative integers, the term is <strong>non-negative integers</strong>. The set of non-negative integers is denoted by \(\mathbb{Z}_{\geq 0}\), and so on with other subscripts. When we say number we will mean integer unless stated otherwise.</p>

<p>The two foundational concepts of number theory are <strong>divisibility</strong> and  <strong>parity</strong> (i.e. even v. odd). The former is more primitive, in the sense that once we define divisibility, we can use this definition to define parity. Here we go:</p>

<blockquote class="mathbox definition" id="def:div">
  <p><strong>Definition 1</strong> (divisibility) <br /><br />
An integer \(a\neq 0\) <strong>divides</strong> another integer \(b\), denoted by \(a \mid b\), if there exists an integer \(k\) such that \(b = ka\). We say \(a\) is a <strong>divisor</strong> (or <strong>factor</strong>) of \(b\), and \(b\) is a <strong>multiple</strong> of \(a\). <br /><br />
If \(a\) does not divide \(b\), we write \(a \nmid b\).</p>
</blockquote>

<p class="notice--warning"><strong>Check</strong> Express divisibility in first-order logic.</p>

<p>Here is the Division Algorithm, which is actually not an algorithm but a theorem:</p>

<blockquote class="mathbox theorem" id="thm:division-algorithm">
  <p><strong>Theorem</strong> (Division Algorithm) <br /><br />
Given any integers \(a\) and \(b\) with \(b&gt;0\), there are unique integers \(q\) and \(r\) such that \(a = bq + r\) and \(0 \leq r &lt; b\).</p>
</blockquote>

<p>Some more terminology:</p>

<blockquote class="mathbox definition" id="def:quotient-remainder">
  <p><strong>Definition</strong> (quotient and remainder) <br /><br />
In the equality of the Division Algorithm, \(a\) is the <strong>dividend</strong>, \(b\) is the <strong>divisor</strong>, \(q\) is the <strong>quotient</strong> and \(r\) is the <strong>remainder</strong>. Other notations for quotient and remainder are \(q = a\; \mathrm{div}\;  b\) and \(r = a \bmod b\).</p>
</blockquote>

<p>The quotient of dividing \(a\) by \(b\) can be expressed by the floor function which given a number (not necessarily integer) returns the largest integer not greater than that number. For example, \(\lfloor 3.7 \rfloor = 3\), \(\lfloor -2.3 \rfloor = -3\), and so on. Using the floor function, we can express the quotient as \(q = \lfloor \frac{a}{b} \rfloor\).</p>

<p class="notice--warning"><strong>Check:</strong> What is the quotient and remainder when -11 is divided by 3?</p>

<p>If you answered the above incorrectly as ‘quotient is -3 and remainder is -2’, on the grounds that \(-11=-3\times3 -2\), you have to re-read <a href="#thm:division-algorithm">Theorem (Division Algorithm)</a>.</p>

<p class="notice--success"><strong>Programming note:</strong> In Python, the floor division operator <code class="language-plaintext highlighter-rouge">//</code> computes the quotient, while the modulo operator <code class="language-plaintext highlighter-rouge">%</code> computes the remainder.</p>

<p>The infinite set \(\mathbb{Z}\) can be partitioned into two infinite subsets: <strong>even</strong> and <strong>odd</strong> integers. Partitioning means when you take the union of even integers and odd integers you get back to \(\mathbb{Z}\), while their intersection is the empty set. In more simple terms, if you are an integer, then you are either odd or even, you cannot be both, and you cannot be anything else. We define these sets:</p>

<blockquote class="mathbox definition" id="def-even-odd">
  <p><strong>Definition 2</strong> (parity) <br /><br />
\(\begin{align}
\forall n \in \mathbb{Z}, n \text{ is even iff }  2\mid n \\
\forall n \in \mathbb{Z}, n \text{ is odd iff } 2\nmid n
\end{align}\)</p>
</blockquote>

<p>In other words  “\(n\) is even” and “\(2 \mid n\)” are the two ways, the latter being more symbolic, to say the same thing. (Isn’t what I just wrote is the definition of definition?)</p>

<p class="notice--warning"><strong>Check:</strong> According to our definition of parity, do we treat 0 as even, odd, or neither?</p>

<p>Given \(n\in \mathbb{Z}\), the set \(\lbrace x : x\mid n\rbrace\) is named the <strong>divisors</strong> of \(n\).<sup id="fnref:divisors"><a href="#fn:divisors" class="footnote" rel="footnote" role="doc-noteref">1</a></sup></p>

<blockquote class="mathbox definition" id="def:proper">
  <p><strong>Definition 2</strong> (proper divisors) <br /><br />
Given an integer \(n\), The <strong>proper divisors</strong> of \(n\) is the set \(\lbrace x: x\neq n, x&gt;0, x\mid n\rbrace\).</p>
</blockquote>

<p class="notice--warning"><strong>Check:</strong> What are the proper divisors of 12? What about -12?</p>

<p>Here is the standard definition of prime numbers:</p>

<blockquote class="mathbox definition" id="def:prime">
  <p><strong>Definition 3</strong> (prime) <br /><br />
A positive integer \(p &gt; 1\) is called a <strong>prime number</strong> (or simply is <strong>prime</strong>) if its only positive divisors are 1 and \(p\) itself.</p>
</blockquote>

<p>Can you think of an alternative definition of prime numbers using the concept of proper divisors we just defined?</p>

<p>Here it is:</p>

<blockquote class="mathbox definition" id="def:prime-alt">
  <p><strong>Definition</strong> (prime – alternative) <br /><br />
A positive integer \(p &gt; 1\) with no proper divisor other than 1 is called a <strong>prime number</strong> (or simply is <strong>prime</strong>).</p>
</blockquote>

<p>Here is another one that does not need \(&gt;1\) condition:</p>

<blockquote class="mathbox definition" id="def:prime-alt3">
  <p><strong>Definition</strong> (prime – alternative 3) <br /><br />
A positive integer \(p\) that has exactly 2 divisors is <strong>prime</strong>..</p>
</blockquote>

<blockquote class="mathbox definition" id="def:composite">
  <p><strong>Definition</strong> (composite numbers) <br /><br />
A positive integer \(n &gt; 1\) that is not prime is <strong>composite</strong>.
Or, equivalently,<br /> \(\forall n &gt;1, n \text{ is composite iff } \exists z \text{ s.t. } z\mid n \text{ and } 1 &lt; z &lt; n\).</p>
</blockquote>

<p>So much for definitions. Let’s now look at some truths we can prove using these definitions. The technical name for such truths is <strong>theorems</strong>. Here is a theorem about parity:</p>

<blockquote class="mathbox theorem" id="thm:odd-square">
  <p><strong>Theorem 1</strong> <br /><br />
For any integer \(n\), if \(n\) is odd, then \(n^2\) is odd.</p>
</blockquote>

<p>Here is a proof:</p>

<blockquote class="mathbox proof" id="proof:odd-square">
  <p><strong>Proof 1</strong> (Theorem 1)<br /><br />
Given that \(n\) is odd, \(n = 2k + 1\) for some integer \(k\).<br /> Then, \(n^2 = (2k +1) (2k +1) = 4k^2 + 4k + 1 = 2(2k^2 + 2k) + 1\).<br /> Since \(2k^2 + 2k\) is an integer, we can say that \(n = 2p + 1\) for some integer \(p=2k^2 + 2k\), and therefore we can conclude that \(n^2\) is odd.</p>
</blockquote>

<p>Looks reasonable. But it is not reasonable. We made use of two “truths” that we have not defined or proved yet: (1) any odd number \(n\) equals \(2k + 1\) for some integer \(k\), and (2) if \(a\) and \(b\) are integers, so are \(a+b\) and \(ab\). To make our proof rigorous, we need to avoid using any unproven statements and undefined terms.</p>

<p>We will first take the following theorem for granted without proving it:</p>

<blockquote class="mathbox theorem" id="thm:closure">
  <p><strong>Theorem 2</strong> (closure)<br /><br />
The set of integers \(\mathbb{Z}\) is closed under addition, multiplication and subtraction. In other words, for any \(a,b \in \mathbb{Z}\), \(a + b, ab, a-b \in \mathbb{Z}\).</p>
</blockquote>

<p class="notice--warning"><strong>Check:</strong> Why is \(\mathbb{Z}\) not closed under division?</p>

<p>Now let us prove this very useful theorem about odd numbers:</p>

<blockquote class="mathbox theorem" id="thm:odd-numbers">
  <p><strong>Theorem 3</strong> (odd numbers)<br /><br />
For any integer \(n\), \(n\) is odd iff there exists an integer \(k\) such that \(n = 2k + 1\).</p>
</blockquote>

<blockquote class="mathbox proof" id="proof:odd-square">
  <p><strong>Proof:</strong> (Theorem 3)<br /><br />
Let \(n\) be odd.<br />
By the division algorithm, there exist integers \(q\) and \(r\) such that \(n = 2q + r\) and \(0 \leq r &lt; 2\).<br />
\(r\) can either be 0 or 1. If \(r\) is 0, then \(n = 2q\), which means \(2 \mid n\), contradicting the assumption that \(n\) is odd.<br />
Therefore, \(r=1\), and \(n = 2q + 1\).<br /></p>
</blockquote>

<p>With Theorem 3 proved, we can now complete the proof of Theorem 1:</p>

<blockquote class="mathbox proof" id="proof:odd-square">
  <p><strong>Proof</strong> (Theorem 1)<br /><br />
Let \(n\) be odd.<br />
Then \(n = 2k +1\) for some \(k\) by Theorem 3<br />
Then, \(n^2 = (2k +1) (2k +1) = 4k^2 + 4k + 1 = 2(2k^2 + 2k) + 1\).<br /> Since \(2k^2 + 2k\) is an integer by Theorem 2, we can say that \(n = 2p + 1\) for some integer \(p=2k^2 + 2k\)<br />
Therefore we can conclude that \(n^2\) is odd.</p>
</blockquote>

<p>Let’s exercise a little more.</p>

<p>I think all of us know the basic facts about divisibility: a number is divisible by 2 if its last digit is divisible by 2 (i.e. even), likewise for 5, and more interestingly, a number is divisible by 3 if the sum of its digits is divisible by 3. It is quite straightforward to convince ourselves of the correctness of the first two facts, but why should the third hold? All of us know <em>that</em> it holds, but only some of us might know <em>why</em> it holds. Knowing that some fact holds can be very useful, in engineering, finance, medical practice, sports, and so on. But in science and mathematics, <em>knowing that</em> is secondary to <em>knowing why</em>.</p>

<p>Give yourself some time to think about why the divisibility rule for 3 holds.</p>

<p>Some of us will see it, perhaps, right away, some will need more time, some will progress only up to a certain point, and some will not even find that initial <em>handle</em> to grasp so that they can start reasoning. The biggest mistake for those who are not happy with their performance (which means all levels except the first) is to put the blame on their mental powers, rather than on the inadequacy of their knowledge of the subject matter, or how math works, or both. Try not to fall into this trap, mathematics is not reserved for mentally privileged people.</p>

<p>Let’s try to discover what we DON’T know that is preventing us from seeing the logic behind the divisibility rule for 3. First, do we really know the rule? The rule is actually not that “a number is divisible by 3 if the sum of its digits is divisible by 3”, but rather “a number is divisible by 3 if the sum of its digits in the decimal representation of it is divisible by 3”. There is no possibility of progress without, explicitly or implicitly, being aware of this nuance. Rule is stated to hold for decimal representation, so the reason why it holds must have something to do with the decimal representation. Do we know, then, what does decimal representation, or even representation, mean for numbers?</p>

<blockquote class="mathbox theorem" id="thm:base-representation">
  <p><strong>Theorem</strong> (base representation) <br /><br />
Given any integer \(n &gt; 0\) and any base \(b \geq 2\), there exist unique integers \(d_0, d_1, \ldots, d_k\) all non-negative and less than \(b\) with \(d_k&gt;0\) such that <br /><br /> \(n = d_k b^k + d_{k-1} b^{k-1} + \ldots + d_1 b^1 + d_0 b^0\).</p>
</blockquote>

<p>For example, \(5097= 5\cdot10^3 + 0\cdot 10^2 + 9\cdot 10^1 + 7\cdot 10^0\), where the base is 10, and the digits are 5,0,9, and 7.</p>

<p>Let’s go back to divisibility by 3. When we write a number in this form, we immediately see that the base terms \(10^i\) except when \(i=0\) are irrelevant for divisibility by 3, you can just ignore them. Why?</p>

<p>Let’s go on trying to discover some other potential gaps in our knowledge and understanding. What is divisibility by 3? If \(3 \mid n\), then there exists an integer \(k\) such that \(n = 3k\). Is there an alternative expression of this state of affairs that would be more useful to us? What about \(n\bmod 3 = 0\). When we are invited to check whether \(3\mid 5097\), we are actually checking whether \(5097 \bmod 3 = 0\). Can we express ‘\(5097 \bmod 3\)’ in terms of 5097’s digits?</p>

<p>For a moment forget about digits. Assume we are asked to find whether 7 is divisible by 3. What do we do? We compute \(7 \bmod 3\) and discover that it is not zero, and answer ‘No’ to the question. What about 3 dividing 17? You would start computing \(17 \bmod 3\) right away, but can’t you also use the result of an earlier computation? (Imagine yourself in a situation where you are asked ‘\(7873298475 \bmod 42\)’ and you know the result for ‘\(7873298400 \bmod 42\)’, wouldn’t it be nice to get away by computing only ‘\(75 \bmod 42\)’ and recycle your earlier result?) Why not, for example, say that \(7\bmod 3=1\) and \(10 \bmod 3= 1\), so \(17\bmod 3\) must be their sum 2, which indeed is \(17\bmod 3\). Can I generalize this? Can I say that given two positive integers \(a\) and \(b\), \((a + b) \bmod 3 = a \bmod 3 + b \bmod 3\)? This doesn’t work, because if both \(a \bmod 3\) and \(b \bmod 3\) equal 2, their sum is 4, which is not a valid value for \(\bmod 3\) – for instance \((8 + 11)\bmod 3\neq (8\bmod 3) + (11\bmod 3)\). But observe that applying \(\bmod 3\) to the result, 4 in this case, will give you the right result. In other words, our specific example obeys the following template \((a + b) \bmod 3 = ((a \bmod 3) + (b \bmod 3)) \bmod 3\)? Does this hold generally? For all \(m&gt;0\)? Yes, it does. Let us state this as a theorem<sup id="fnref:modadd"><a href="#fn:modadd" class="footnote" rel="footnote" role="doc-noteref">2</a></sup> and prove it.</p>

<blockquote class="mathbox theorem" id="thm:modular-addition">
  <p><strong>Theorem</strong> (modular addition) <br /><br />
For any integers \(a,b\) and any positive integer \(m\), \((a + b) \bmod m = ( (a \bmod m) + (b \bmod m) ) \bmod m\).</p>
</blockquote>

<blockquote class="mathbox proof" id="proof:modular-addition">
  <p><strong>Proof</strong> (modular addition)<br /><br />
Let \(a,b \in \mathbb{Z}\) and \(m \in \mathbb{Z}^+\).<br />
By the Division Algorithm \((a + b) \bmod m = r_1 = a + b - pm\), for some \(p\).<br /> 
Likewise \(((a \bmod m) + (b \bmod m) ) \bmod m = r_2 = (a - qm) + (b - sm) - tm\), for some \(q,s,t\).<sup id="fnref:rda"><a href="#fn:rda" class="footnote" rel="footnote" role="doc-noteref">3</a></sup><br />
We need to show that \(r_1 = r_2\).<br />
By rearrangment, \(r_2 = a + b - m(q + s + t)\)
Then \(r_1 - r_2 = m(q+s+t-p)\)<br />
We know that \(r_1,r_2&lt; m\), by the definition of the remainder in the Division Algorithm.<br />
Therefore, \(r_1-r_2\) cannot be equal to or greater than \(m\) and cannot be less than or equal to \(-m\), i.e.  \(-m &lt; r_1 - r_2 &lt; m\).<br />
The only way this condition holds is when \(q+s+t-p\), an integer, is equal to 0, which means \(r_1 = r_2\).<br /></p>
</blockquote>

<p>The same logic holds for multiplication as well:</p>

<blockquote class="mathbox theorem" id="thm:modular-multiplication">
  <p><strong>Theorem</strong> (modular multiplication) <br /><br />
For any integers \(a,b\) and any positive integer \(m\), \((ab) \bmod m = ( (a \bmod m)(b \bmod m) ) \bmod m\).</p>
</blockquote>

<p>The proof, which is similar to the above, is left as an exercise.</p>

<p>Where are we now on divisibility by 3? We now know that whenever we are asked about ‘\(10n\bmod 3\)’ we can answer that it is ‘\(n\bmod 3\)’, because we know that:</p>

\[\begin{align*}
10n\bmod 3 &amp;=&amp; ((10 \bmod 3)(n\bmod 3)) \bmod 3 \\
&amp;=&amp;(n\bmod 3) \bmod 3\\
&amp;=&amp;n\bmod 3
\end{align*}\]

<p>By the iterated application of this logic, you can have in general:</p>

<blockquote class="mathbox lemma" id="lemma:powers-of-10-mod-3">
  <p><strong>Lemma</strong> (powers of 10 mod 3) <br /><br />
For any non-negative integer \(k\) and any integer \(n\), \(10^k n \bmod 3 = n \bmod 3\), by <a href="#thm:modular-multiplication">Theorem (modular multiplication)</a>.<br /></p>
</blockquote>

<p>We are all set in terms of building blocks. Let’s combine them all:</p>

<blockquote class="mathbox lemma" id="lemma:sum-of-digits-mod-3">
  <p><strong>Lemma</strong> (sum of digits mod 3) <br /><br />
Given any positive integer \(n\) with the decimal representation<br />
\(n = d_k10^k + d_{k-1}10^{k-1} + \ldots + d_110^1 + d_010^0\),<br />
\(n \bmod 3 = (d_k10^k + d_{k-1}10^{k-1} \ldots d_110^1 + d_010^0) \bmod 3\)<br />
which, by <a href="#thm:modular-addition">Theorem (modular addition)</a>, is,<br />
\(((d_k10^k \bmod 3) + (d_{k-1}10^{k-1}\bmod 3) + \ldots +\) <br />
\(\quad\quad\quad\quad(d_110^1\bmod 3) + (d_010^0 \bmod 3)) \bmod 3\)<br />
which, by <a href="#lemma:powers-of-10-mod-3">Lemma (powers of 10 mod 3)</a>, is,<br />
\(((d_k \bmod 3) + (d_{k-1}\bmod 3) + \ldots +\)<br />\(\quad\quad\quad\quad(d_1\bmod 3) + (d_0 \bmod 3)) \bmod 3\)<br />
which, once again by <a href="#thm:modular-addition">Theorem (modular addition)</a>, is,<br />
\((d_k + d_{k-1} + \ldots + d_1 + d_0) \bmod 3\), <br />
establishing, <br /> \(n \bmod 3 =(d_k + d_{k-1} + \ldots + d_1 + d_0) \bmod 3\)<br />
Which is to say that a positive integer \(n\) is divisible by 3 iff the sum of the digits in its decimal representation is divisible by 3.</p>
</blockquote>

<p>It’s been a long day, I know. But one final example. One that, like the above, trades on some property of number 3. Here is a claim about prime numbers that we need to check:</p>

<blockquote class="mathbox claim" id="claim:3-primes">
  <p><strong>Claim</strong> (3 consecutive primes) <br /><br />
3, 5, and 7 are three consecutive prime numbers, in the sense that there is no odd composite number intervening. There is no other triple of consecutive prime numbers.</p>
</blockquote>

<p>There are the following strategies to approach these types of statements.</p>
<ol>
  <li>You find an instance that contradicts the claim. In this case a triple of consecutive primes other than 3,5,7.</li>
  <li>You assume that there exists such a triple other than 3,5,7, and then show that this assumption leads to a contradiction.</li>
  <li>You pick an arbitrary triple of consecutive primes, where all you are entitled to know that (i) they are primes, (ii) they are consecutive in the Claim’s sense, and (ii) the first of them is not 3. You convince the reader that the triple you picked cannot be all primes, which amounts to showing that  <em>any</em>  triple other than 3,5,7 is guaranteed NOT to be all prime, proving the claim.</li>
</ol>

<p>This particular claim gives itself to the third strategy.</p>

<p>Think and try before I give you a clue.</p>

<p>Clue 1: The claim states that there cannot be any integer \(p\neq 3\) such that \(p, p+2, p+4\) are all prime. Make sure you understand the conditions of the problem.</p>

<p>Think and try before I give you another clue.</p>

<p>Clue 2: You can show any such triple other than 3,5,7 must include a number divisible by 3.</p>

<p>Think and try before I give you the final clue.</p>

<p>Clue 3: Concentrate on \(p \bmod 3\).</p>

<p>Think and try before you look at the proof.</p>

<p>Here is the proof, which concludes this post:</p>

<blockquote class="mathbox proof" id="proof:3-primes">
  <p><strong>Proof</strong> (Claim 3 consecutive primes)<br /><br />
Let \(p, p+2, p+4\) be any three consecutive odd numbers with \(p \geq 5\).<br />
Either \(3\mid p\) or \(3\nmid p\).<br />
If \(3\mid p\), then \(p\) is composite, the triple cannot be all primes.<br />
else if \(3\nmid p\) then either \(p \bmod 3=1\) or \(p\bmod 3 = 2\). <br />
If \(p\bmod 3=1\), then \((p+2) \bmod 3 = 0\), which means \(3\mid (p+2)\), and therefore \(p+2\) is composite.<br />
If \(p\bmod 3=2\), then \((p+4) \bmod 3 = 0\), which means \(3\mid (p+4)\), and therefore \(p+4\) is composite.<br />
Simply there is no way that a triple other than 3,5,7 can be all primes.</p>
</blockquote>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:divisors">
      <p>There is subtle difference between the sense we use “divisor” in this context and the sense we used it in the Division Algorithm. When talking about the divisors of a number \(n\) in the current context, when we say \(k\) is a divisor of \(n\),  we mean  \(k\) divides \(n\) without leaving a remainder. In the division algorithm, the divisor is a number that divides another number, but may leave a remainder. <a href="#fnref:divisors" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:modadd">
      <p>This actually is corollary of a more major theorem about <strong>congruences</strong>, which we leave out of scope for now. <a href="#fnref:modadd" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:rda">
      <p>We  used the Division Algorithm three times, once for each term connected by ‘+’, and once for the overall \(\bmod\). <a href="#fnref:rda" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name></name></author><category term="course" /><category term="discrete" /><category term="proof" /><category term="number theory" /><summary type="html"><![CDATA[Fundamental notions of number theory and proof techniques.]]></summary></entry><entry><title type="html">Higher order functions</title><link href="https://umutozge.github.io/posts/course/higher-order-functions/" rel="alternate" type="text/html" title="Higher order functions" /><published>2025-11-21T00:00:00+03:00</published><updated>2025-11-21T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/higher-order-functions</id><content type="html" xml:base="https://umutozge.github.io/posts/course/higher-order-functions/"><![CDATA[<p>Remember our <a href="/blog/iteration-by-while">earlier</a> discussion of Collatz function and sequences. Here is our task:</p>

<p class="notice--info"><strong>Task:</strong> Given a positive integer \(n\), find the largest integer in the Collatz sequence seeded by \(n\).<sup id="fnref:wonder"><a href="#fn:wonder" class="footnote" rel="footnote" role="doc-noteref">1</a></sup></p>

<p>By now, the task should be a piece of cake for you. Is it? Try and see before proceeding.</p>

<p>Here we go:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">The Collatz function </span><span class="sh">"""</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>     <span class="c1"># // instead of / for an integer result
</span>    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span>

<span class="k">def</span> <span class="nf">largest_collatz</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the largest number in the Collatz sequence seeded by n.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">largest_collatz</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="mi">8</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">largest_collatz</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="mi">16</span>
    <span class="sh">"""</span>
    <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">collatz</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">largest_so_far</span><span class="p">:</span>
            <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">largest_so_far</span>

</code></pre></div></div>

<p>Remember our principle “do one thing at a time”. Does it hold for <code class="language-plaintext highlighter-rouge">largest_collatz</code>? What was our test? We ask ourselves  does this function have parts that might be useful for other tasks? The function enters into a loop, has a specific way to get the next item in the sequence, and keeps track of the largest number seen so far. This appears to be a task we might want to perform for other sequences as well. For example, we could have the task to find the largest number in the <strong>aliquot sequence</strong> (read “AL-i-kwot”) of a number, where the next number in the sequence is obtained by summing the proper divisors of the current number.<sup id="fnref:aliquot"><a href="#fn:aliquot" class="footnote" rel="footnote" role="doc-noteref">2</a></sup> Like Collatz sequences, aliquot sequences also can fluctuate.<sup id="fnref:fluc"><a href="#fn:fluc" class="footnote" rel="footnote" role="doc-noteref">3</a></sup> Assume, although wrongly, that an aliquot sequence always ends at 1.</p>

<p>If our task was to find the largest number in an aliquot sequence, what would have changed in the above code? Just a single name! We would have <code class="language-plaintext highlighter-rouge">aliquot</code> instead of <code class="language-plaintext highlighter-rouge">collatz</code>, where the former would be the name of the function that computes the next number in the aliquot sequence. This shows that we can separate (1) the task of finding the largest number in a sequence from (2) the task of computing the next number in that sequence.</p>

<p>The function that computes the next aliquot number is an exercise you need to tackle. But let’s assume we already have a function <code class="language-plaintext highlighter-rouge">next_aliquot</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">next_aliquot</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the next number in the aliquot sequence seeded by n.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">next_aliquot</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
    <span class="mi">16</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">next_aliquot</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="mi">9</span>
    <span class="sh">"""</span>
    <span class="c1"># Assume the function is properly defined and usable 
</span>    <span class="k">pass</span>
</code></pre></div></div>

<p>You are about to pass a milestone in your programming journey, read carefully. To separate the task of finding the largest in a sequence from the choice of a particular sequence, we abstract the sequence function from our <code class="language-plaintext highlighter-rouge">largest_collatz</code> function. This is done by replacing the name <code class="language-plaintext highlighter-rouge">collatz</code> in our function with the name <code class="language-plaintext highlighter-rouge">sequencer</code> (any name will be fine) and make <code class="language-plaintext highlighter-rouge">sequencer</code> a parameter of our function. Here is how:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">largest_in_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sequencer</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the largest number in the sequence seeded by n using sequencer function.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">largest_in_sequence</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">collatz</span><span class="p">)</span>
    <span class="mi">8</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">largest_in_sequence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">collatz</span><span class="p">)</span>
    <span class="mi">16</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">largest_in_sequence</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">next_aliquot</span><span class="p">)</span>
    <span class="mi">16</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">largest_in_sequence</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">next_aliquot</span><span class="p">)</span>
    <span class="mi">9</span>
    <span class="sh">"""</span>
    <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">sequencer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">largest_so_far</span><span class="p">:</span>
            <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">largest_so_far</span>
</code></pre></div></div>

<p>Of course we no longer call our function <code class="language-plaintext highlighter-rouge">largest_collatz</code>. With this function, you can now find the largest number in <em>any</em> sequence defined by a function that computes the next number in that sequence. You just need to pass the appropriate function as the second argument. If you want to find the largest number in a Collatz sequence seeded by 183, call <code class="language-plaintext highlighter-rouge">largest_in_sequence(183, collatz)</code>, if you are interested in the largest number in an aliquot sequence seeded by the same number, call <code class="language-plaintext highlighter-rouge">largest_in_sequence(183, next_aliquot)</code>.</p>

<p>There is big lie in the above paragraph. What is it?</p>

<p>Our function would work fine with Collatz sequences, and with <em>some</em> aliquot sequences, but not with <em>any</em> sequence. Because our function assumes that the sequence ends in 1. This does not have to be so in the general case. We have to free ourselves from that 1, you might think. And for someone who has started abstracting functions, abstracting a number should not be a problem: simply add a third parameter for <code class="language-plaintext highlighter-rouge">stop_value</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">largest_in_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sequencer</span><span class="p">,</span> <span class="n">stop_value</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the largest number in the sequence seeded by n using sequencer function. </span><span class="sh">"""</span>
    <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">stop_value</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">sequencer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">largest_so_far</span><span class="p">:</span>
            <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">largest_so_far</span>
</code></pre></div></div>

<p>Seems OK. But is it?</p>

<p>What if I wanted to stop when a number in my sequence becomes odd, prime or, say, one of the prime factors of 38592? These cases cannot be handled by passing a number to my function to be inserted to the right of <code class="language-plaintext highlighter-rouge">!=</code>. Any ideas?</p>

<p>Once again I need a more general, more abstract way to handle the problem. Why don’t I use a function parameter again, this time named, say,  <code class="language-plaintext highlighter-rouge">alive</code>, which when applied to my iteration parameter \(n\) returns <code class="language-plaintext highlighter-rouge">True</code> if I need to continue, and <code class="language-plaintext highlighter-rouge">False</code> if I need to stop? Here is the updated code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">largest_in_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sequencer</span><span class="p">,</span> <span class="n">alive</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the largest number in the sequence seeded by n using sequencer function. </span><span class="sh">"""</span>
    <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">while</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">sequencer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">largest_so_far</span><span class="p">:</span>
            <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">largest_so_far</span>
</code></pre></div></div>

<p>Now with this function and the function below:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">not_div_7_3</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Check whether n is NOT divisable by 3 and 7.</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>I can find the largest number in the Collatz sequence seeded by 1000 that is encountered before we reach a number divisible by both 3 and 7, with the following call:<sup id="fnref:silly"><a href="#fn:silly" class="footnote" rel="footnote" role="doc-noteref">4</a></sup></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nf">largest_in_sequence</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">div_7_3</span><span class="p">)</span>
</code></pre></div></div>

<p>Well, we already have gone a long way. Is it time to rest? One final check: Look again at our latest <code class="language-plaintext highlighter-rouge">largest_in_sequence</code> function. Does it do “one thing only”? Take your time; but you know, if it did, I wouldn’t ask this question.</p>

<p>It doesn’t. There is still room for abstraction. Again it might not be easy to see, but use our test: Does this function have parts that might be useful for other tasks? What would you need to change in this function if the task was to find the <em>smallest</em> number in a sequence rather than the largest? You might, rightly, think finding the smallest does not make sense in Collatz – why is that by the way?  But assume the task is to find not the largest or smallest number in the sequence, but the number with the largest or smallest sum of digits. What would change in the code?
Please think before proceeding. Try to come up with your own modification.</p>

<p>Here is another abstraction, this time the comparison bit has been abstracted into a function <code class="language-plaintext highlighter-rouge">beats</code>, which when applied to two numbers returns True, if the first number is “better” than the second according to some criterion, and False otherwise. Here is the final code:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">best_in_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sequencer</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">beats</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the </span><span class="sh">'</span><span class="s">best</span><span class="sh">'</span><span class="s"> number according to beats in the sequence seeded by n using sequencer function. </span><span class="sh">"""</span>
    <span class="n">best_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">while</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">sequencer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="nf">beats</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">best_so_far</span><span class="p">):</span>
            <span class="n">best_so_far</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">best_so_far</span>
</code></pre></div></div>

<p>Assume you want to find the largest number in the Collatz sequence seeded by 176 whose sum of digits is even. Assuming you already solved the exercise of writing a function <code class="language-plaintext highlighter-rouge">sum_of_digits</code> that computes the sum of digits of a number, all you need is to define the following two functions:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">beats</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Check whether x is greater than y and its sum of digits is even.</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="nf">sum_of_digits</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Check whether n is not 1.</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>and call:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nf">best_in_sequence</span><span class="p">(</span><span class="mi">176</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">beats</span><span class="p">)</span>
</code></pre></div></div>

<p>A couple of notes are in order:</p>
<ol>
  <li>The reason I defined the functions we will send as parameters to <code class="language-plaintext highlighter-rouge">best_in_sequence</code> with the names <code class="language-plaintext highlighter-rouge">alive</code> and <code class="language-plaintext highlighter-rouge">beats</code> is just that I couldn’t think of better names. You can name them whatever you like. In this current form, they are totally different from the same names we used in the definition of <code class="language-plaintext highlighter-rouge">best_in_sequence</code>. If this point is not perfectly clear to you, please ask me about it.</li>
  <li>When we say “do one thing at a time”, we do not rule out functions like our final <code class="language-plaintext highlighter-rouge">beats</code> function that do two things: compare two numbers and apply a criterion (like sum of digits even). This is because such functions are small enough and focused enough to be considered as doing one thing. There is no general use of parts of it for other tasks.</li>
  <li>Our <code class="language-plaintext highlighter-rouge">alive</code> seems a little idiotic to define, after all it just checks whether a number is not equal to 1. We have to do it in this ugly way for some time until we learn about lambda functions. When that shiny day arrives, the call to <code class="language-plaintext highlighter-rouge">best_in_sequence</code> would look like this:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nf">best_in_sequence</span><span class="p">(</span><span class="mi">176</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">!=</span><span class="mi">1</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="nf">sum_of_digits</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&gt;</span><span class="n">y</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>and we will not have to define these small functions separately.</p>

<p>Well. Does the final version of our function <code class="language-plaintext highlighter-rouge">best_in_sequence</code> obey our principle “do one thing at a time”?</p>

<p>It very persuasively stands to be obeying the principle. One might say that <code class="language-plaintext highlighter-rouge">best_in_sequence</code> does one thing: find the best item in a given sequence using a given criterion. Incidentally, note that the sequence is not <em>passed</em> to our function as a single object but came in three pieces, namely the seed (or start), the sequencer function, and the alive function, which tells when the sequence ends. No harm for now, we promised to abstract away the source part, we didn’t promise that we will do it as a single parameter abstraction.</p>

<p>Let’s turn back to our question of whether <code class="language-plaintext highlighter-rouge">best_in_sequence</code> affords further abstractions. All we need is to apply our test and ask:  do we listen to sources only to pick the best item according to some criterion? Or can there be other reasons why we listen to a source? What if we were asked to take the sum of all the integers encountered in reducing a seed to 1 by Collatz function? This is a slightly different problem than above, but cannot be solved by our function. We need a new function, perhaps something like this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sum_in_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sequencer</span><span class="p">,</span> <span class="n">alive</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the sum of numbers in the sequence seeded by n using sequencer function. </span><span class="sh">"""</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">n</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">sequencer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span>
</code></pre></div></div>

<p>What if we wanted the product of the numbers in the sequence? Mean? Geometric mean? Would you write separate functions for each? You can of course, but you should not, actually you <em>need</em> not. Let’s first get rid of our dependence on the particular summation business. We will have a store (or accumulator) that we will update at each turn of our loop, and the update will be done by a function, passed as a parameter, that will apply to the current item in the sequence <em>and</em> the current value of the store.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">accumulate_in_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sequencer</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the accumulated value in the sequence seeded by n using sequencer function. </span><span class="sh">"""</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">acc</span> <span class="o">=</span> <span class="nf">update</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">sequencer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">acc</span>
</code></pre></div></div>

<p>Now if you want to add numbers in a Collatz sequence, have your update function and other parameters ready. Write the update function before proceeding.<sup id="fnref:add"><a href="#fn:add" class="footnote" rel="footnote" role="doc-noteref">5</a></sup></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
  <span class="sh">"""</span><span class="s">Return the sum of acc and item.</span><span class="sh">"""</span>
  <span class="k">return</span> <span class="n">acc</span> <span class="o">+</span> <span class="n">item</span>

<span class="k">def</span> <span class="nf">is_alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
  <span class="sh">"""</span><span class="s">Return True if n is not 1.</span><span class="sh">"""</span>
  <span class="k">return</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">collatz</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
  <span class="sh">"""</span><span class="s">Return the next number in the Collatz sequence.</span><span class="sh">"""</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></div>

<p>and call your function like this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nf">accumulate_in_sequence</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">is_alive</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span>
</code></pre></div></div>

<p>What if you want to find the largest number in the sequence? Is it doable with <code class="language-plaintext highlighter-rouge">accumulate_in_sequence</code>? Or do you need to use the good old <code class="language-plaintext highlighter-rouge">best_in_sequence</code>? Think.</p>

<p>It is perfectly doable, even fun to do. You do not even need to write a new update function. Simply pass Python’s <code class="language-plaintext highlighter-rouge">max</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nf">accumulate_in_sequence</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">collatz</span><span class="p">,</span> <span class="n">is_alive</span><span class="p">,</span> <span class="nb">max</span><span class="p">)</span>
</code></pre></div></div>

<p>One final touch, in case it escaped your eye till now: our <code class="language-plaintext highlighter-rouge">accumulate_in_sequence</code> function initializes the store to 0. This is fine for summation, but not for other tasks. Make the initial state of your store a parameter. Here is the final version, with a more general name for processing sequences:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">proc_seq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">sequencer</span><span class="p">,</span> <span class="n">alive</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">init</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the accumulated value in the sequence seeded by n using sequencer function. </span><span class="sh">"""</span>
    <span class="n">store</span> <span class="o">=</span> <span class="n">init</span>
    <span class="k">while</span> <span class="nf">alive</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">store</span> <span class="o">=</span> <span class="nf">update</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">sequencer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">store</span>
</code></pre></div></div>

<p>Here is an important question that you can use to test your understanding of what is going on here, I mean regarding higher order functions and abstraction: How would you, now, solve the problem of finding the largest positive integer \(n\) with the largest Collatz length s.t. \(1 &lt; n &lt; k\) for a given \(k\)? I give you 1000 (\(k\)) and you return me the largest positive smaller integer with a Collatz length not smaller than any other you can find in the range from 1 to 1000.</p>

<p>With the power of higher-order functions, we gradually formed a general purpose, highly abstract function that can be used in an enormous variety of computational tasks.</p>

<p>There will surely be complaints about having a five parameter function. Given its power, five is not bad at all, but you can reduce it for most cases by keyword parameters, which is a topic for another day.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:wonder">
      <p>Don’t you wonder whether there is a unique largest integer in a Collatz sequence? Is it possible to visit a number you’ve already visited in a Collatz sequence? <a href="#fnref:wonder" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:aliquot">
      <p>Do not confuse <strong>proper divisors</strong> with <strong>prime divisors</strong> of a number. Any positive divisor of \(n\) other than \(n\) itself is a proper divisor. Prime divisors of \(n\), on the other hand, are divisors of \(n\) that are prime. For example, 12 has the proper divisors 1, 2, 3, 4 and 6, and the prime divisors 2 and 3. What are the proper and prime divisors of 7? <a href="#fnref:aliquot" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:fluc">
      <p>Try 30 as seed. <a href="#fnref:fluc" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:silly">
      <p>Yes, I know this is a silly task. <a href="#fnref:silly" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:add">
      <p>You don’t need to write it actually; you can simply import it by <code class="language-plaintext highlighter-rouge">from operator import add</code>. <a href="#fnref:add" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name></name></author><category term="course" /><category term="programming" /><category term="funprog" /><summary type="html"><![CDATA[An introduction to higher-order functions in programming.]]></summary></entry><entry><title type="html">Iteration by `while`</title><link href="https://umutozge.github.io/posts/course/iteration-by-while/" rel="alternate" type="text/html" title="Iteration by `while`" /><published>2025-11-13T00:00:00+03:00</published><updated>2025-11-13T00:00:00+03:00</updated><id>https://umutozge.github.io/posts/course/iteration-by-while</id><content type="html" xml:base="https://umutozge.github.io/posts/course/iteration-by-while/"><![CDATA[<p>Let’s start with a simple function defined over integers called the Collatz function \(C\).</p>

\[C(n) =
\begin{cases}
\frac{n}{2} &amp; \text{if } n \text{ is even}\\
3n + 1 &amp; \text{if } n \text{ is odd}
\end{cases}\]

<p><strong>Collatz’ conjecture</strong> states that for any positive integer \(n\), repeated application of \(C\) will eventually reach 1.
The <strong>Collatz sequence</strong> of a given positive integer \(n\) is the sequence of numbers obtained by repeatedly applying \(C\) starting from \(n\) until reaching 1. We will call \(n\) the <strong>seed</strong> of the sequence, and also use phrases like “a (Collatz) sequence seeded by \(n\)”, and so on. When we talk about the Collatz sequence of a number, we will include the starting number and the ending 1 in the sequence, this is good because by looking at the sequence, you immediately see how it started and that it is completed. Finally, we will use the phrase
“Collatz sequence seeded by \(n\)” to refer to the Collatz sequence generated to reduce \(n\) to 1.</p>

<p class="notice--warning"><strong>Check:</strong> Write the Collatz sequence seeded by 11.</p>

<p>One can be interested in many questions about Collatz sequence. For one:</p>

<p class="notice--info"><strong>Question:</strong> Given an upper bound \(k \geq 1\), find the seed \(n \leq k\) that produces the longest Collatz sequence.</p>

<p>The first question to ask about a programming problem is what are the inputs and outputs of the function we want to write. Here, the input is a positive integer \(k\), and the output is another positive integer \(n \leq k\) that produces the longest Collatz sequence among all integers from 1 to \(k\).</p>

<p>Once this global input-output relation is clear, the next step is to think about how to break this relation into smaller parts, or simpler problems that we can solve one by one to reach the final solution. At this point, a strategy that works quite well in most cases is to ask “What do I have to be able to do in order to solve this problem?”</p>

<p>Let’s list:</p>
<ol>
  <li>Given a seed \(n\), we need to be able to compute the Collatz sequence seeded by \(n\).</li>
  <li>We need to be able to compute the length of a given sequence.</li>
  <li>We need to be able to compare lengths of multiple sequences and come up with the longest sequence.</li>
  <li>Finding the longest sequence is not enough, we also need to remember the seed that produced that sequence.</li>
</ol>

<p>We can start with the first one. What is the input-output relation for this subproblem? Input is a positive  integer \(n\), and output is the Collatz sequence seeded by \(n\), which is a list (or sequence) of integers. We have a problem here since we do not know yet constructing lists in Python. But we can at least print the numbers in the Collatz sequence one by one. Here is how we can do that using a <code class="language-plaintext highlighter-rouge">while</code> loop:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">print_collatz_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Print the Collatz sequence seeded by n.</span><span class="sh">"""</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>   <span class="c1"># checks whether n is even
</span>            <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="nf">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Print the last element of the sequence
</span></code></pre></div></div>

<p>There is a very important principle in good programming that we need to follow as tightly as we can:</p>

<p class="notice--success"><strong>Principle:</strong> Each function should do one thing.</p>

<p>Think for a moment whether <code class="language-plaintext highlighter-rouge">print_collatz_sequence</code> follows this principle. It might appear to be so. But actually, it does two things. It computes the Collatz function for numbers within a loop, and it prints the numbers. That there are two separable tasks might not be obvious to you for the moment, but here is a simple test: What if we wanted to add the numbers in a Collatz sequence rather than print them on screen? That code would be very similar to the one we wrote. There would be the exact same or very similar lines for computing the next number in the sequence. The following bit:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>   <span class="c1"># checks whether n is even
</span>    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></div>

<p>The only difference would be that instead of printing the number, we would add it to a running total. This shows that our function is doing two things: computing the next number in the sequence, and printing it. Here is a useful principle:</p>

<p class="notice--success"><strong>Principle:</strong> Examining the function you wrote, if you discover blocks of code (like the <code class="language-plaintext highlighter-rouge">if</code> statement above) that might be useful for other tasks as well, separate that block into another function and use that function instead of the block.</p>

<p>In our example, this principle dictates us to write a separate function to apply the Collatz function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">The Collatz function
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">collatz</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="mi">0</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">collatz</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="mi">10</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">collatz</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="mi">4</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">collatz</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
    <span class="o">-</span><span class="mi">4</span>
    <span class="sh">"""</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>     <span class="c1"># // instead of / for an integer result
</span>    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span>
</code></pre></div></div>

<p>and handle the printing of the sequence with:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">print_collatz_sequence</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Print the Collatz sequence seeded by n.
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">print_collatz_sequence</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="mi">8</span>
    <span class="mi">4</span>
    <span class="mi">2</span>
    <span class="mi">1</span>
    <span class="sh">"""</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">collatz</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Print the last element of the sequence
</span></code></pre></div></div>

<p>What we actually want is the length of the sequence, not its display on the screen. To get the length we will have to violate our principle of doing one thing at a time in a function. But this is only a temporary thing, once we learn how to form the sequences themselves, rather than their prints on the screen, we will get back to our principle. For now, counting has to be done like this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collatz_length</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">The length of the Collatz sequence seeded by n (n and 1 are included)
</span><span class="gp">
    &gt;&gt;&gt;</span> <span class="nf">collatz_length</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="mi">4</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">collatz_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="mi">8</span>
    <span class="sh">"""</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">collatz</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">counter</span>
</code></pre></div></div>

<p>We seem to have all the ingredients we need to solve our original problem. But let’s do not rush. Let’s try to abstract a little away from our problem. The problem can be thought as a composition of two components:
    1. There is a <strong>message source</strong> that generates numbers in order. You can also think of it as a stream, or a channel.
    1. There is a <strong>listener</strong> (or <strong>receiver</strong>) that listens to the channel and keeps the record of the largest number received so far.</p>

<p>The generating source can vary from problem to problem, but the listener has a more general character. For example, the source could have been random integers between, say 1 and 1000000 (a million), and assume we were asked to find the largest such integer in \(k\) random integers. The code would look like:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">largest_random</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Return the largest of k ranndom integers between 1 and 1000000.</span><span class="sh">"""</span>
    <span class="kn">from</span> <span class="n">random</span> <span class="kn">import</span> <span class="n">randint</span>
    <span class="n">largest_so_far</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">counter</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="n">largest_so_far</span><span class="p">:</span>
            <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">r</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">largest_so_far</span>
</code></pre></div></div>

<p>The function <code class="language-plaintext highlighter-rouge">randint</code> is imported from the <code class="language-plaintext highlighter-rouge">random</code> module, and generates a random integer between the two arguments (inclusive).</p>

<p>If our problem were to find the largest length rather than the seed that yields the largest length, we would have a very similar function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">largest_collatz_length</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">The largest Collatz length for the seeds between 1 and k.</span><span class="sh">"""</span>
    <span class="n">largest_so_far</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">counter</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">:</span>
        <span class="n">current_length</span> <span class="o">=</span> <span class="nf">collatz_length</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current_length</span> <span class="o">&gt;</span> <span class="n">largest_so_far</span><span class="p">:</span>
            <span class="n">largest_so_far</span> <span class="o">=</span> <span class="n">current_length</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">largest_so_far</span>
</code></pre></div></div>

<p>Ours is a little more complicated than this. We need to remember the seed that produced the largest length as well. Here is the final code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">maximal_collatz_seed</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">The largest seed between 1 and k that produces the largest Collatz length.</span><span class="sh">"""</span>
    <span class="n">largest_length</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">seed_with_largest_length</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">counter</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">:</span>
        <span class="n">current_length</span> <span class="o">=</span> <span class="nf">collatz_length</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current_length</span> <span class="o">&gt;</span> <span class="n">largest_length</span><span class="p">:</span>
            <span class="n">largest_length</span> <span class="o">=</span> <span class="n">current_length</span>
            <span class="n">seed_with_largest_length</span> <span class="o">=</span> <span class="n">counter</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">seed_with_largest_length</span>

</code></pre></div></div>

<p>Once again we could not follow our principle of “one thing at a time” in the above function. The source component and listener component are fused together. In the earlier case we were helpless because we did not know how to construct sequences. If we knew we could have separated the construction and length components. The reason we are helpless in the current case is that we do not know about higher order functions – functions that take other functions as arguments. Once we learn about them, we will be able to separate the source and listener components.</p>

<p>Finally, notice that I wrote “The largest seed between 1 and k that produces the largest Collatz length” in the docstring. Why is that? Why did I say “the <em>largest</em> seed”?</p>]]></content><author><name></name></author><category term="course" /><category term="iteration" /><summary type="html"><![CDATA[An introduction to iteration using while loops in Python, illustrated with the Collatz conjecture.]]></summary></entry></feed>